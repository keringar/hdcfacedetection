<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BitMagic-C++: bmxor.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BitMagic-C++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">bmxor.h</div></div>
</div><!--header-->
<div class="contents">
<a href="bmxor_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef BMXORFUNC__H__INCLUDED__</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define BMXORFUNC__H__INCLUDED__</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span><span class="comment">/*</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span><span class="comment">Copyright(c) 2002-2019 Anatoliy Kuznetsov(anatoliy_kuznetsov at yahoo.com)</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span><span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span><span class="comment">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span><span class="comment">you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span><span class="comment">You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span><span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span><span class="comment">Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span><span class="comment">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span><span class="comment">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span><span class="comment">See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span><span class="comment">limitations under the License.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span><span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span><span class="comment">For more information please visit:  http://bitmagic.io</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span><span class="comment">*/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span><span class="comment"></span> </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span><span class="comment">/*! \file bmxor.h</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span><span class="comment">    \brief Functions and utilities for XOR filters (internal)</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span><span class="comment">*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="bmdef_8h.html">bmdef.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="bmutil_8h.html">bmutil.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span><span class="keyword">namespace </span><a class="code" href="namespacebm.html">bm</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span><span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span><span class="comment">/**</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span><span class="comment">    Parameters for XOR similarity search.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span><span class="comment">    Tuneup params allows to reduce the search space to better</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span><span class="comment">    balance compression rate vs speed.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span><span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span><span class="comment">    min_lookup_depth - default: 0,  minimal search depth to still try to improve</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span><span class="comment">    max_lookup_depth - default: (2billion) maximum scan search</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span><span class="comment">        Set a smaller number to improve search time</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span><span class="comment"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span><span class="comment">    Example:</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span><span class="comment">    min_lookup_depth = 64; max_lookup_depth = 1024;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span><span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span><span class="comment">    stop_gain - default: 65533 - cutoff to stop search when serch found gain</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span><span class="comment">                better than &quot;stop_gain&quot; absolute value</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span><span class="comment">    Example:</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span><span class="comment">    stop_gain = 10000;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span><span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span><span class="comment">    target_gain_ratio - default: 0.89 - cut off ratio between original block cost</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span><span class="comment">                        metric and XOR basedd metric to stop searching.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span><span class="comment">                        (90% better than the original block is &quot;good enough&quot;)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span><span class="comment">    Example:</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span><span class="comment">    target_gain_ratio = 0.50; // 50% improvement is good enough</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span><span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span><span class="comment">    min_gaps - default: 3 - minimal size of GAP block to be considered for</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span><span class="comment">                            XOR search candidate</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span><span class="comment"> */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html">   58</a></span><span class="keyword">struct </span><a class="code" href="structbm_1_1xor__sim__params.html">xor_sim_params</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>{</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#a8ac8f9f08a60f991fd78708f67d19515">   60</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1xor__sim__params.html#a8ac8f9f08a60f991fd78708f67d19515">min_lookup_depth</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">   61</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">max_lookup_depth</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#a777f9468e2cf75d79db603b35d59eaa2">   62</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1xor__sim__params.html#a777f9468e2cf75d79db603b35d59eaa2">stop_gain</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#af9393fc7693813404eb2c9161f59c3d5">   63</a></span>    <span class="keywordtype">float</span>    <a class="code" href="structbm_1_1xor__sim__params.html#af9393fc7693813404eb2c9161f59c3d5">target_gain_ratio</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">   64</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">min_gaps</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__params.html#ab9ae4ddd083e2156bb8572e8f86e8afb">   66</a></span>    <a class="code" href="structbm_1_1xor__sim__params.html#ab9ae4ddd083e2156bb8572e8f86e8afb">xor_sim_params</a>()</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>    : <a class="code" href="structbm_1_1xor__sim__params.html#a8ac8f9f08a60f991fd78708f67d19515">min_lookup_depth</a>(0),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>      <a class="code" href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">max_lookup_depth</a>(~0u/2),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>      <a class="code" href="structbm_1_1xor__sim__params.html#a777f9468e2cf75d79db603b35d59eaa2">stop_gain</a>(<a class="code" href="namespacebm.html">bm</a>::<a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">gap_max_bits</a>-3),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>      <a class="code" href="structbm_1_1xor__sim__params.html#af9393fc7693813404eb2c9161f59c3d5">target_gain_ratio</a>(0.89f),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>      <a class="code" href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">min_gaps</a>(3)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>    {}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span><span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span><span class="comment">/**</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span><span class="comment">    XOR complementarity type between 2 blocks</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span><span class="comment"> */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">   80</a></span><span class="keyword">enum</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">xor_complement_match</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>{</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">   82</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a> = 0,</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">   83</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">e_xor_match_GC</a>,</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">   84</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">e_xor_match_BC</a>,</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">   85</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">e_xor_match_iBC</a>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">e_xor_match_EQ</a></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">   87</a></span>};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span><span class="comment"></span> </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span><span class="comment">/*!</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span><span class="comment">    Function (32-bit) calculates basic complexity statistics on XOR product of</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span><span class="comment">    two blocks (b1 XOR b2)</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span><span class="comment">    @ingroup bitfunc</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span><span class="comment">*/</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="group__bitfunc.html#ga3a7dc6e5554518cbf2c5f54129833a52">   96</a></span><span class="keywordtype">void</span> <a class="code" href="group__bitfunc.html#ga3a7dc6e5554518cbf2c5f54129833a52">bit_block_xor_change32</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> block,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>                            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xor_block,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>                            <span class="keywordtype">unsigned</span> size,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>                            <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> gc,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>                            <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> bc) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(gc &amp;&amp; bc);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>    <span class="keywordtype">unsigned</span> gap_count = 1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>    <span class="keywordtype">unsigned</span> bit_count = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>    <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>  w, w0, w_prev, w_l;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>    w = w0 = *block ^ *xor_block;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>    bit_count += <a class="code" href="group__bitfunc.html#ga0cac3b111c2a2f9cc1995d2c3e94f361">word_bitcount</a>(w);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> w_shift = int(<span class="keyword">sizeof</span>(w) * 8 - 1);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>    w ^= (w &gt;&gt; 1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>    gap_count += <a class="code" href="group__bitfunc.html#ga0cac3b111c2a2f9cc1995d2c3e94f361">bm::word_bitcount</a>(w);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>    gap_count -= (w_prev = (w0 &gt;&gt; w_shift)); <span class="comment">// negative value correction</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* block_end = block + size;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>    <span class="keywordflow">for</span> (++block, ++xor_block; block &lt; block_end; ++block, ++xor_block)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>    {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>        w = w0 = *block ^ *xor_block;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>        bit_count += <a class="code" href="group__bitfunc.html#ga0cac3b111c2a2f9cc1995d2c3e94f361">bm::word_bitcount</a>(w);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>        ++gap_count;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>        <span class="keywordflow">if</span> (!w)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>        {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>            gap_count -= !w_prev;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>            w_prev = 0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>        {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>            w ^= (w &gt;&gt; 1);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>            gap_count += <a class="code" href="group__bitfunc.html#ga0cac3b111c2a2f9cc1995d2c3e94f361">bm::word_bitcount</a>(w);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>            w_l = w0 &amp; 1;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>            gap_count -= (w0 &gt;&gt; w_shift);  <span class="comment">// negative value correction</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>            gap_count -= !(w_prev ^ w_l);  <span class="comment">// word border correction</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>            w_prev = (w0 &gt;&gt; w_shift);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>    } <span class="comment">// for</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>    *gc = gap_count;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>    *bc = bit_count;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span><span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span><span class="comment">/*!</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span><span class="comment">    Function (64-bit) calculates basic complexity statistics on XOR product of</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span><span class="comment">    two blocks (b1 XOR b2)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span><span class="comment">    @ingroup bitfunc</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span><span class="comment">*/</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="group__bitfunc.html#ga0cbf0c0227b7624f95bd9cff87e2e032">  151</a></span><span class="keywordtype">void</span> <a class="code" href="group__bitfunc.html#ga0cbf0c0227b7624f95bd9cff87e2e032">bit_block_xor_change64</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> s_block,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>                            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> ref_block,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>                            <span class="keywordtype">unsigned</span> size,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>                            <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> gc,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>                            <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> bc) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(gc &amp;&amp; bc);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>    <span class="keywordtype">unsigned</span> gap_count = 1;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>    <span class="keywordtype">unsigned</span> bit_count = 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> block =   (<span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*) s_block;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xor_block =  (<span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*) ref_block;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>  w, w0, w_prev, w_l;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>    w = w0 = *block ^ *xor_block;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>    bit_count += <a class="code" href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">word_bitcount64</a>(w);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> w_shift = int(<span class="keyword">sizeof</span>(w) * 8 - 1);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>    w ^= (w &gt;&gt; 1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>    gap_count += <a class="code" href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">bm::word_bitcount64</a>(w);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>    gap_count -= unsigned(w_prev = (w0 &gt;&gt; w_shift)); <span class="comment">// negative value correction</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* block_end = block + (size/2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>    <span class="keywordflow">for</span> (++block, ++xor_block; block &lt; block_end; ++block, ++xor_block)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>        w = w0 = *block ^ *xor_block;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>        bit_count += <a class="code" href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">bm::word_bitcount64</a>(w);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>        ++gap_count;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>        <span class="keywordflow">if</span> (!w)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>        {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>            gap_count -= !w_prev;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>            w_prev = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>        {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>            w ^= (w &gt;&gt; 1);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>            gap_count += <a class="code" href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">bm::word_bitcount64</a>(w);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>            w_l = w0 &amp; 1;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>            gap_count -= unsigned(w0 &gt;&gt; w_shift);  <span class="comment">// negative value correction</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>            gap_count -= !(w_prev ^ w_l);  <span class="comment">// word border correction</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>            w_prev = (w0 &gt;&gt; w_shift);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>    } <span class="comment">// for</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>    *gc = gap_count;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>    *bc = bit_count;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span><span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span><span class="comment">/*!</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span><span class="comment">    Function calculates number of times when bit value changed</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span><span class="comment">*/</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="namespacebm.html#afddbb0034ce383a1fc2693196c472c81">  207</a></span><span class="keywordtype">void</span> <a class="code" href="namespacebm.html#afddbb0034ce383a1fc2693196c472c81">bit_block_xor_change</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> block,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>                              <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xor_block,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>                              <span class="keywordtype">unsigned</span> size,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>                              <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> gc,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>                              <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> bc) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span><span class="preprocessor">#ifdef VECT_BLOCK_XOR_CHANGE</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>    <a class="code" href="bmavx2_8h.html#affdafd867133ecb554f3a79d61929dff">VECT_BLOCK_XOR_CHANGE</a>(block, xor_block, size, gc, bc);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span><span class="preprocessor">    #ifdef BM64OPT</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>        <a class="code" href="group__bitfunc.html#ga0cbf0c0227b7624f95bd9cff87e2e032">bm::bit_block_xor_change64</a>(block, xor_block, size, gc, bc);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span><span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>        <a class="code" href="group__bitfunc.html#ga3a7dc6e5554518cbf2c5f54129833a52">bm::bit_block_xor_change32</a>(block, xor_block, size, gc, bc);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span><span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span><span class="comment"></span> </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span><span class="comment">/**</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span><span class="comment">    Structure to compute XOR gap-count profile by sub-block waves</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span><span class="comment">    @ingroup bitfunc</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span><span class="comment">*/</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structbm_1_1block__waves__xor__descr.html">  229</a></span><span class="keyword">struct </span><a class="code" href="structbm_1_1block__waves__xor__descr.html">block_waves_xor_descr</a></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// stats for s-block</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structbm_1_1block__waves__xor__descr.html#a89973edd27d865c4fa4ee285d92fa03b">  232</a></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structbm_1_1block__waves__xor__descr.html#a89973edd27d865c4fa4ee285d92fa03b">sb_gc</a>[<a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>]; <span class="comment">///&lt; GAP counts</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structbm_1_1block__waves__xor__descr.html#a78c4c60344fc7c0c3eb88b0ec7af1c70">  233</a></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structbm_1_1block__waves__xor__descr.html#a78c4c60344fc7c0c3eb88b0ec7af1c70">sb_bc</a>[<a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>]; <span class="comment">///&lt; BIT counts</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>    <span class="comment">// stats ref.block XOR mask</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structbm_1_1block__waves__xor__descr.html#a953d914d8772981bbfa709bd1f8c1353">  236</a></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structbm_1_1block__waves__xor__descr.html#a953d914d8772981bbfa709bd1f8c1353">sb_xor_gc</a>[<a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>]; <span class="comment">///&lt; XOR-mask GAP count</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="structbm_1_1block__waves__xor__descr.html#ae6cf7b55a41c738b35769362323432af">  237</a></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structbm_1_1block__waves__xor__descr.html#ae6cf7b55a41c738b35769362323432af">sb_xor_bc</a>[<a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>]; <span class="comment">///&lt; XOR-mask GAP count</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>};</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span><span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span><span class="comment">/**</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span><span class="comment">    Capture the XOR filter results (xor block against ref.block)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span><span class="comment"> */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html">  244</a></span><span class="keyword">struct </span><a class="code" href="structbm_1_1block__xor__match__descr.html">block_xor_match_descr</a></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>{</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#ad7cdb4c6d880958e453d42e142c8ef28">  246</a></span>    <span class="keyword">typedef</span> <a class="code" href="namespacebm.html#acd2b71d7a1e902a6f5bbf87c725ecacc">bvector_size_type</a>   <a class="code" href="structbm_1_1block__xor__match__descr.html#ad7cdb4c6d880958e453d42e142c8ef28">size_type</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">  248</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a>  <a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a>; <span class="comment">///&lt; match type</span></div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">  249</a></span>    <span class="keywordtype">unsigned</span>                  <a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a>; <span class="comment">///&lt; XOR filter improvement (best)</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">  250</a></span>    <a class="code" href="structbm_1_1block__xor__match__descr.html#ad7cdb4c6d880958e453d42e142c8ef28">size_type</a>                 <a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a>;    <span class="comment">///&lt; reference vector index</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">  251</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>                <a class="code" href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">xor_d64</a>;    <span class="comment">///&lt; recorded digest</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>    <span class="comment">// sub-block waves masks for metrics</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a6838dd2e66ec91998d4fb105d52a21f0">  254</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>   <a class="code" href="structbm_1_1block__xor__match__descr.html#a6838dd2e66ec91998d4fb105d52a21f0">gc_d64</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a67625671ed19599882cdc3d71908df22">  255</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>   <a class="code" href="structbm_1_1block__xor__match__descr.html#a67625671ed19599882cdc3d71908df22">bc_d64</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#aee655146c2715f0df84dd9c3c3e96628">  256</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>   <a class="code" href="structbm_1_1block__xor__match__descr.html#aee655146c2715f0df84dd9c3c3e96628">ibc_d64</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>    <span class="comment">// recorded gains for metrics</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a15dd01eabe9804009215d4e4e0bb8285">  259</a></span>    <span class="keywordtype">unsigned</span>     <a class="code" href="structbm_1_1block__xor__match__descr.html#a15dd01eabe9804009215d4e4e0bb8285">gc_gain</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a32fcb9286c0c93a1d68f849b88f94a91">  260</a></span>    <span class="keywordtype">unsigned</span>     <a class="code" href="structbm_1_1block__xor__match__descr.html#a32fcb9286c0c93a1d68f849b88f94a91">bc_gain</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#aa2c08db6838741df09378fb872b4acec">  261</a></span>    <span class="keywordtype">unsigned</span>     <a class="code" href="structbm_1_1block__xor__match__descr.html#aa2c08db6838741df09378fb872b4acec">ibc_gain</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a3a194d3e860da37c6e16755805574788">  263</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1block__xor__match__descr.html#a3a194d3e860da37c6e16755805574788">xor_gc</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#a4c65e8e6d0079b20d78ef17ec5ea50d8">  264</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="structbm_1_1block__xor__match__descr.html#a4c65e8e6d0079b20d78ef17ec5ea50d8">xor_bc</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="structbm_1_1block__xor__match__descr.html#aa251e7696aba3937edff85160886708e">  266</a></span>    <a class="code" href="structbm_1_1block__xor__match__descr.html#aa251e7696aba3937edff85160886708e">block_xor_match_descr</a>() : <a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a>(<a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>) {}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>};</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span><span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span><span class="comment">/**</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span><span class="comment">    XOR match pair</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span><span class="comment"> */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="structbm_1_1match__pair.html">  273</a></span><span class="keyword">struct </span><a class="code" href="structbm_1_1match__pair.html">match_pair</a></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>{</div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">  275</a></span>    <a class="code" href="namespacebm.html#acd2b71d7a1e902a6f5bbf87c725ecacc">bvector_size_type</a>         <a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>;    <span class="comment">///&lt; reference vector index</span></div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">  276</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>                <a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>;    <span class="comment">///&lt; recorded digest</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="structbm_1_1match__pair.html#ab76ae550e9851327936ca1dd3bf6ba4c">  278</a></span>    <a class="code" href="structbm_1_1match__pair.html#ab76ae550e9851327936ca1dd3bf6ba4c">match_pair</a>(){}</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="structbm_1_1match__pair.html#af6ee46c5d97cf5c3aeb0f0aef0e9417d">  279</a></span>    <a class="code" href="structbm_1_1match__pair.html#af6ee46c5d97cf5c3aeb0f0aef0e9417d">match_pair</a>(<a class="code" href="namespacebm.html#acd2b71d7a1e902a6f5bbf87c725ecacc">bvector_size_type</a> idx, <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d64)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>    : <a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>(idx), <a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>(d64)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>    {}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>};</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span><span class="comment"></span> </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span><span class="comment">/**</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span><span class="comment">    XOR match chain</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span><span class="comment"> */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html">  289</a></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BLOCK_IDX&gt; <span class="keyword">struct </span><a class="code" href="structbm_1_1block__match__chain.html">block_match_chain</a></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>{</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#a409849a3a91d76d8512918531d64680c">  291</a></span>    BLOCK_IDX                <a class="code" href="structbm_1_1block__match__chain.html#a409849a3a91d76d8512918531d64680c">nb</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">  292</a></span>    <span class="keywordtype">unsigned</span>                 <a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">  293</a></span>    <span class="keywordtype">unsigned</span>                 <a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[64];</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">  294</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>               <a class="code" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">xor_d64</a>[64];</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">  295</a></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a> <a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="structbm_1_1block__match__chain.html#a83fad2d17507bda2e7cb4a36f452f9a4">  297</a></span>    <span class="keywordtype">bool</span> <a class="code" href="structbm_1_1block__match__chain.html#a83fad2d17507bda2e7cb4a36f452f9a4">operator==</a>(<span class="keyword">const</span> <a class="code" href="structbm_1_1block__match__chain.html">block_match_chain</a>&amp; bmc) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>    {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>        <span class="keywordflow">if</span> (<a class="code" href="structbm_1_1block__match__chain.html#a409849a3a91d76d8512918531d64680c">nb</a> != bmc.nb || <a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a> != bmc.chain_size || <a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> != bmc.match)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>        {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>; ++i)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>        {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>            <span class="keywordflow">if</span> (<a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[i] != bmc.ref_idx[i])</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>            <span class="keywordflow">if</span> (<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> == <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">e_xor_match_EQ</a>)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>            <span class="keywordflow">if</span> (<a class="code" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">xor_d64</a>[i] != bmc.xor_d64[i])</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>};</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span><span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span><span class="comment">/**</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span><span class="comment">    Greedy algorithm to find additional matches</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span><span class="comment">    improving the inital best match block on its match type</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span><span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span><span class="comment">    @param match_pairs_vect - [out] target vector of best match pairs</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span><span class="comment">    @param match_vect - [in/out] vector of all found match descriptors</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span><span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span><span class="comment">    @return number of new finds (if any)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span><span class="comment"> */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> PVT, <span class="keyword">typename</span> VT&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span><span class="keyword">typename</span> VT::size_type</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="namespacebm.html#a46a7c02fff53ca169e6482d4942f96f7">  327</a></span><a class="code" href="namespacebm.html#a46a7c02fff53ca169e6482d4942f96f7">greedy_refine_match_vector</a>(PVT&amp;                      match_pairs_vect,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>                           VT&amp;                       match_vect,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>                           <span class="keyword">typename</span> VT::size_type    best_ref_idx,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>                           <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>                d64,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>                           <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a>  match_type)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(match_type &amp;&amp; d64);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>    match_pairs_vect.resize(0);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>  d64_acc(d64);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>    <span class="comment">// pass 1 (exact match)</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>    <span class="comment">//</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>    <span class="keyword">typename</span> VT::size_type sz = match_vect.size();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>    <span class="keywordflow">for</span> (<span class="keyword">typename</span> VT::size_type i = 0; (i &lt; sz) &amp;&amp; (d64_acc != ~0ull); ++i)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>    {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>        <a class="code" href="structbm_1_1block__xor__match__descr.html">block_xor_match_descr</a>&amp; xmd = match_vect[i];</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>        <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a> == best_ref_idx) <span class="comment">// self hit</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>        <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a> == match_type) <span class="comment">// best compatible match types</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>        {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>            <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d64_new = ~~d64_acc &amp; xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">xor_d64</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>            <span class="keywordflow">if</span> (d64_new)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>            {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>                d64_acc |= d64_new;    <span class="comment">// add mask to accum</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>                match_pairs_vect.push_back(<a class="code" href="structbm_1_1match__pair.html">bm::match_pair</a>(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a>, d64_new));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>            }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>            xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a> = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>; <span class="comment">// mark it to exclude from pass 2</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>    <span class="comment">// pass 2 (extended match)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>    <span class="comment">//</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> min_gain_cut_off = 50;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>    <span class="keywordflow">for</span> (<span class="keyword">typename</span> VT::size_type i = 0; (i &lt; sz) &amp;&amp; (d64_acc != ~0ull); ++i)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>        <a class="code" href="structbm_1_1block__xor__match__descr.html">block_xor_match_descr</a>&amp; xmd = match_vect[i];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>        <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a> == best_ref_idx || !xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a>) <span class="comment">// self hit or none</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a> != match_type);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>        <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d64_new = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>        <span class="keywordflow">switch</span> (match_type)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>        {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>        <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">e_xor_match_GC</a>:</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>            <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a15dd01eabe9804009215d4e4e0bb8285">gc_gain</a> &gt; min_gain_cut_off)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>                d64_new = ~~d64_acc &amp; xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a6838dd2e66ec91998d4fb105d52a21f0">gc_d64</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>        <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">e_xor_match_BC</a>:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>            <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a32fcb9286c0c93a1d68f849b88f94a91">bc_gain</a> &gt; min_gain_cut_off)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>                d64_new = ~~d64_acc &amp; xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a67625671ed19599882cdc3d71908df22">bc_d64</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>        <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">e_xor_match_iBC</a>:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>            <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#aa2c08db6838741df09378fb872b4acec">ibc_gain</a> &gt; min_gain_cut_off)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>                d64_new = ~~d64_acc &amp; xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#aee655146c2715f0df84dd9c3c3e96628">ibc_d64</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>        } <span class="comment">// switch</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>        <span class="keywordflow">if</span> (d64_new) <span class="comment">// some improvement found</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>        {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>            d64_acc |= d64_new;    <span class="comment">// add mask to accum</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>            match_pairs_vect.push_back(<a class="code" href="structbm_1_1match__pair.html">bm::match_pair</a>(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a>, d64_new));</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>            xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a> = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>        }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>    } <span class="comment">// for</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>    <span class="keywordflow">return</span> match_pairs_vect.size();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span><span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span><span class="comment">/**</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span><span class="comment">    Check effective bit-rate for the XOR encode vector</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span><span class="comment">    @return 1 - &lt; 256 (8bit), 2 - &lt; 65536 (16-bit) or 0 - 32-bit</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span><span class="comment"> */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BMChain, <span class="keyword">typename</span> RVect&gt;</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="namespacebm.html#a1ca7473948f0c934f771454f5b1c4e28">  404</a></span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="namespacebm.html#a1ca7473948f0c934f771454f5b1c4e28">check_pair_vect_vbr</a>(<span class="keyword">const</span> BMChain&amp; mchain, <span class="keyword">const</span> RVect&amp; ref_vect)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>    <span class="keywordtype">size_t</span> max_idx = 0;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; mchain.chain_size; ++i)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>    {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>        <a class="code" href="namespacebm.html#acd2b71d7a1e902a6f5bbf87c725ecacc">bvector_size_type</a> ridx = mchain.ref_idx[i];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>        ridx = ref_vect.get_row_idx(ridx);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>        <span class="keywordflow">if</span> (ridx &gt; max_idx)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>            max_idx = ridx;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>    <span class="keywordflow">if</span> (max_idx &lt; 256)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>    <span class="keywordflow">if</span> (max_idx &lt; 65536)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>}</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span><span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span><span class="comment">/**</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span><span class="comment">    Compute reference (non-XOR) 64-dim complexity descriptor for the</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span><span class="comment">    s-block.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span><span class="comment">    Phase 1 of the XOR filtering process is to establish the base metric</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span><span class="comment"></span> </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span><span class="comment">*/</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="namespacebm.html#a34977fdaa1b6fc8dc9951bc7eba98ea6">  430</a></span><span class="keywordtype">void</span> <a class="code" href="namespacebm.html#a34977fdaa1b6fc8dc9951bc7eba98ea6">compute_s_block_descr</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> block,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>                        <a class="code" href="structbm_1_1block__waves__xor__descr.html">block_waves_xor_descr</a>&amp; <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> x_descr,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>                        <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> s_gc,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>                        <span class="keywordtype">unsigned</span>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> s_bc) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>    *s_gc = *s_bc = 0;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>    <span class="comment">// TODO: SIMD (for loop can go inside VECT to minimize LUT re-inits)</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>; ++i)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>        <span class="keywordtype">unsigned</span> off = (i * <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* sub_block = block + off;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>        <span class="keywordtype">unsigned</span> gc, bc;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>        <span class="comment">// TODO: optimize to compute GC and BC in a single pass</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span><span class="preprocessor">        #if defined(VECT_BLOCK_CHANGE)</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>            gc = <a class="code" href="bmavx2_8h.html#abadfad850d54694fd0fa1fccc630628e">VECT_BLOCK_CHANGE</a>(sub_block, <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span><span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span><span class="preprocessor">            #ifdef BM64OPT</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>                gc = <a class="code" href="namespacebm.html#a396465b416ef1bc9d72afad6d088b759">bm::bit_block_change64</a>(sub_block, <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>                <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(gc == <a class="code" href="namespacebm.html#a99bf2a95e59b587281b7058ea9e7d04c">bm::bit_block_change32</a>(sub_block, <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>));</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span><span class="preprocessor">            #else</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>                gc = <a class="code" href="namespacebm.html#a99bf2a95e59b587281b7058ea9e7d04c">bm::bit_block_change32</a>(sub_block, <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span><span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span><span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>        bc = <a class="code" href="group__bitfunc.html#ga0f3ced2486b1b44958aaa446c3f45174">bm::bit_count_min_unroll</a>(</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>                    sub_block, sub_block + <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>        x_descr.sb_bc[i] = (<span class="keywordtype">unsigned</span> short) bc;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>        *s_bc += bc;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>        <span class="keywordflow">if</span> (i) <span class="comment">// wave border correction</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>        {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a> w_l = sub_block[-1];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a> w_r = sub_block[0] &amp; 1;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>            w_l &gt;&gt;= 31;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>            gc -= (w_l == w_r);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>        }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>        x_descr.sb_gc[i] = (<span class="keywordtype">unsigned</span> short) gc;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>        *s_gc += gc;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>    <span class="comment">// TODO: compute and return d64 - use it later</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>}</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span><span class="comment"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span><span class="comment">/**</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span><span class="comment">    Build partial XOR product of 2 bit-blocks using digest mask</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span><span class="comment"></span> </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span><span class="comment">    @param target_block - target := block ^ xor_block</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span><span class="comment">    @param block - arg1</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span><span class="comment">    @param xor_block - arg2</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span><span class="comment">    @param digest - mask for each block wave to XOR (1) or just copy (0)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span><span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span><span class="comment">*/</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="namespacebm.html#acebf91bf821499da1a53bbd4ada88961">  483</a></span><span class="keywordtype">void</span> <a class="code" href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bit_block_xor</a>(<a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>*         target_block,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>                   <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>*   block,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>                   <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>*   xor_block,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>                   <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>          digest) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(target_block);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(block);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(xor_block);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(digest);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span><span class="preprocessor">#ifdef VECT_BIT_BLOCK_XOR</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>    <a class="code" href="bmavx2_8h.html#a4a2b40d7ba2f2cae74d22c4a9680c675">VECT_BIT_BLOCK_XOR</a>(target_block, block, xor_block, digest);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>; ++i)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>    {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> mask = (1ull &lt;&lt; i);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>        <span class="keywordtype">unsigned</span> off = (i * <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span><span class="preprocessor">    #ifdef BM64OPT</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* sub_block = (<span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*)(block + off);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>        <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* t_sub_block = (<a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*)(target_block + off);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* sub_block_end = sub_block + <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>/2;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>        <span class="keywordflow">if</span> (digest &amp; mask) <span class="comment">// XOR filtered sub-block</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>        {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* xor_sub_block = (<span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*)(xor_block + off);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>            <span class="keywordflow">for</span> ( ;sub_block &lt; sub_block_end; )</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>            {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>                t_sub_block[0] = sub_block[0] ^ xor_sub_block[0];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>                t_sub_block[1] = sub_block[1] ^ xor_sub_block[1];</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>                t_sub_block[2] = sub_block[2] ^ xor_sub_block[2];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>                t_sub_block[3] = sub_block[3] ^ xor_sub_block[3];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>                t_sub_block+=4; sub_block+=4; xor_sub_block+=4;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>        }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>        <span class="keywordflow">else</span> <span class="comment">// just copy the source</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>        {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>            <span class="keywordflow">for</span> (; sub_block &lt; sub_block_end; t_sub_block+=4, sub_block+=4)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>            {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>                t_sub_block[0] = sub_block[0];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>                t_sub_block[1] = sub_block[1];</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>                t_sub_block[2] = sub_block[2];</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>                t_sub_block[3] = sub_block[3];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span><span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* sub_block = block + off;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>        <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* t_sub_block = target_block + off;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* sub_block_end = sub_block + <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>        <span class="keywordflow">if</span> (digest &amp; mask) <span class="comment">// XOR filtered sub-block</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>        {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* xor_sub_block = xor_block + off;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>            <span class="keywordflow">for</span> (; sub_block &lt; sub_block_end; )</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>            {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>                t_sub_block[0] = sub_block[0] ^ xor_sub_block[0];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>                t_sub_block[1] = sub_block[1] ^ xor_sub_block[1];</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>                t_sub_block[2] = sub_block[2] ^ xor_sub_block[2];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>                t_sub_block[3] = sub_block[3] ^ xor_sub_block[3];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>                t_sub_block+=4; sub_block+=4; xor_sub_block+=4;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>        <span class="keywordflow">else</span> <span class="comment">// just copy the source</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>        {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>            <span class="keywordflow">for</span> (; sub_block &lt; sub_block_end; t_sub_block+=4, sub_block+=4)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>            {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>                t_sub_block[0] = sub_block[0];</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>                t_sub_block[1] = sub_block[1];</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>                t_sub_block[2] = sub_block[2];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>                t_sub_block[3] = sub_block[3];</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>        }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span><span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>}</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span><span class="comment"></span> </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span><span class="comment">/**</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span><span class="comment">    Build partial XOR product of 2 bit-blocks using digest mask</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span><span class="comment"></span> </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span><span class="comment">    @param target_block - target := target ^ xor_block</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span><span class="comment">    @param xor_block - arg</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span><span class="comment">    @param digest - mask for each block wave to XOR (1)</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span><span class="comment"></span> </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span><span class="comment">*/</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span><span class="keyword">inline</span></div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="namespacebm.html#ab754b89a764dc1c71cb06ad5353764c1">  569</a></span><span class="keywordtype">void</span> <a class="code" href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bit_block_xor</a>(<a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* target_block, <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>*  xor_block,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>                   <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> digest) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>{</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(target_block);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(xor_block);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(digest);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span><span class="preprocessor">    #ifdef VECT_BIT_BLOCK_XOR_2WAY</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>        <a class="code" href="bmavx2_8h.html#af137f165b3b57f7c30b5a5da5f1a273f">VECT_BIT_BLOCK_XOR_2WAY</a>(target_block, xor_block, digest);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span><span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>        <span class="keywordflow">while</span> (digest)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>        {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>            <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> t = <a class="code" href="namespacebm.html#ae1af13fc16ae99f74d327349d49803ae">bm::bmi_blsi_u64</a>(digest); <span class="comment">// d &amp; -d;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>            <span class="keywordtype">unsigned</span> wave = <a class="code" href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">bm::word_bitcount64</a>(t - 1);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>            <span class="keywordtype">unsigned</span> off = wave * <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span><span class="preprocessor">        #ifdef BM64OPT</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* xor_sub_block = (<span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*)(xor_block + off);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>            <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* t_sub_block = (<a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>*)(target_block + off);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>* t_sub_block_end = (t_sub_block + <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>/2);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>            <span class="keywordflow">for</span> (; t_sub_block &lt; t_sub_block_end; t_sub_block+=4, xor_sub_block+=4)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>            {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>                t_sub_block[0] ^= xor_sub_block[0];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>                t_sub_block[1] ^= xor_sub_block[1];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>                t_sub_block[2] ^= xor_sub_block[2];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>                t_sub_block[3] ^= xor_sub_block[3];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span><span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* xor_sub_block = xor_block + off;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* t_sub_block = target_block + off;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* t_sub_block_end = t_sub_block + <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>            <span class="keywordflow">for</span> (; t_sub_block &lt; t_sub_block_end; t_sub_block+=4, xor_sub_block+=4)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>            {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>                t_sub_block[0] ^= xor_sub_block[0];</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>                t_sub_block[1] ^= xor_sub_block[1];</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>                t_sub_block[2] ^= xor_sub_block[2];</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>                t_sub_block[3] ^= xor_sub_block[3];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>            } <span class="comment">// for</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span><span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>            digest = <a class="code" href="namespacebm.html#ab8eaf7a7124a6f55049c0cb49a08a4f8">bm::bmi_bslr_u64</a>(digest); <span class="comment">// d &amp;= d - 1;</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>        } <span class="comment">// while</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span><span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>}</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span><span class="comment"></span> </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span><span class="comment">/**</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span><span class="comment">    List of reference bit-vectors with their true index associations</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span><span class="comment"></span> </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span><span class="comment">    Each referece vector would have two alternative indexes:</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span><span class="comment">     - index(position) in the reference list</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span><span class="comment">     - index(row) in the external bit-matrix (plane index)</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span><span class="comment"></span> </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span><span class="comment">*/</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html">  623</a></span><span class="keyword">class </span><a class="code" href="classbm_1_1bv__ref__vector.html">bv_ref_vector</a></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>{</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">  626</a></span>    <span class="keyword">typedef</span> BV                                          <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">  627</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#a7fea809653a2792c84fd10c92b5c47c4">bvector_type::size_type</a>            <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a68c28b8f86c4e0cf8afe26cab1140892">  628</a></span>    <span class="keyword">typedef</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>*                               <a class="code" href="classbm_1_1bv__ref__vector.html#a68c28b8f86c4e0cf8afe26cab1140892">bvector_type_ptr</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a7da407ddf3f5ac59b1702ae236d85ce8">  629</a></span>    <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>*                         <a class="code" href="classbm_1_1bv__ref__vector.html#a7da407ddf3f5ac59b1702ae236d85ce8">bvector_type_const_ptr</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#ae6dbbc3eddbb53aa254838221aa58151">  630</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#ad1dbe63690fd5cd2b1e064795d3f1b6c">bvector_type::allocator_type</a>       <a class="code" href="classbm_1_1bv__ref__vector.html#ae6dbbc3eddbb53aa254838221aa58151">bv_allocator_type</a>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a3969b4db5654ba15c67a6f7df32edbdd">  633</a></span>    <span class="keyword">typedef</span> <a class="code" href="structbm_1_1block__match__chain.html">bm::block_match_chain&lt;size_type&gt;</a>            <a class="code" href="classbm_1_1bv__ref__vector.html#a3969b4db5654ba15c67a6f7df32edbdd">block_match_chain_type</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>    <span class="keyword">typedef</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>    bm::dynamic_heap_matrix&lt;block_match_chain_type, bv_allocator_type&gt;</div>
<div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">  636</a></span>                                                             <a class="code" href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">matrix_chain_type</a>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span><span class="comment"></span> </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span><span class="comment">    /// reset the collection (resize(0))</span></div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a99b7a8a3de7a6f72ca28499c5bec59a6">  641</a></span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a99b7a8a3de7a6f72ca28499c5bec59a6">reset</a>()</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>    {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">rows_acc_</a> = 0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>.resize(0); <a class="code" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">ref_bvects_rows_</a>.resize(0);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span><span class="comment"></span> </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span><span class="comment">        Add reference vector</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span><span class="comment">        @param bv - bvector pointer</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span><span class="comment">        @param ref_idx - reference (row) index</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span><span class="comment">    */</span></div>
<div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a7fb37bd870f784e018a684dd82b78165">  652</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a7fb37bd870f784e018a684dd82b78165">add</a>(<span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>* bv, <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> ref_idx)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>    {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(bv);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>.push_back(bv);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">ref_bvects_rows_</a>.push_back(ref_idx);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span><span class="comment"></span> </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span><span class="comment">    /// Get reference list size</span></div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">  660</a></span><span class="comment"></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> <a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a>)<a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>.size(); }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span><span class="comment"></span> </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span><span class="comment">    /// Get reference vector by the index in this ref-vector</span></div>
<div class="line"><a name="l00663"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a8a243086235da1b0d79143e293468463">  663</a></span><span class="comment"></span>    <span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>* <a class="code" href="classbm_1_1bv__ref__vector.html#a8a243086235da1b0d79143e293468463">get_bv</a>(<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> idx) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>                                        { <span class="keywordflow">return</span> <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>[idx]; }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span><span class="comment"></span> </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span><span class="comment">    /// Get reference row index by the index in this ref-vector</span></div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a99679bf7956b39ee02507370751006a8">  667</a></span><span class="comment"></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> <a class="code" href="classbm_1_1bv__ref__vector.html#a99679bf7956b39ee02507370751006a8">get_row_idx</a>(<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> idx) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>                        { <span class="keywordflow">return</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a>)<a class="code" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">ref_bvects_rows_</a>[idx]; }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span><span class="comment"></span> </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span><span class="comment">    /// not-found value for find methods</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span><span class="comment"></span>    <span class="keyword">static</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a5da7772d7bc4a8bfa6bafd479f1c2550">  672</a></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> <a class="code" href="classbm_1_1bv__ref__vector.html#a5da7772d7bc4a8bfa6bafd479f1c2550">not_found</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> ~(<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a>(0)); }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span><span class="comment"></span> </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span><span class="comment">    /// Find vector index by the reference index</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span><span class="comment">    /// @return ~0 if not found</span></div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#acffc08ae19830be62e6a0ccff1d760f9">  676</a></span><span class="comment"></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> <a class="code" href="classbm_1_1bv__ref__vector.html#acffc08ae19830be62e6a0ccff1d760f9">find</a>(std::size_t ref_idx) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>    {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> sz = <a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>        <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> i = 0; i &lt; sz; ++i) <span class="comment">// TODO: optimization</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>            <span class="keywordflow">if</span> (ref_idx == <a class="code" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">ref_bvects_rows_</a>[i])</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>                <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>        <span class="keywordflow">return</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a5da7772d7bc4a8bfa6bafd479f1c2550">not_found</a>();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>    }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span><span class="comment"></span> </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span><span class="comment">    /// Find vector index by the pointer</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span><span class="comment">    /// @return ~0 if not found</span></div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a955266146f2c6d48b3ff5ee329a35e23">  687</a></span><span class="comment"></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> <a class="code" href="classbm_1_1bv__ref__vector.html#a955266146f2c6d48b3ff5ee329a35e23">find_bv</a>(<span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>* bv) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>    {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> sz = <a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>        <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> i = 0; i &lt; sz; ++i)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>            <span class="keywordflow">if</span> (bv == <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>[i])</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>                <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>        <span class="keywordflow">return</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a5da7772d7bc4a8bfa6bafd479f1c2550">not_found</a>();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>    }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span><span class="comment"></span> </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span><span class="comment">    /// Fill block allocation digest for all vectors in the reference collection</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span><span class="comment">    ///   @param bv_blocks - [out] bvector of blocks statistics</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a42a9b5c13231d2032ba2189a96153c01">  699</a></span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a42a9b5c13231d2032ba2189a96153c01">fill_alloc_digest</a>(<a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>&amp; bv_blocks)<span class="keyword"> const</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span><span class="keyword">    </span>{</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> sz = <a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>        <span class="keywordflow">if</span> (sz)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>            <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> i = 0; i &lt; sz; ++i)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>                <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>[i]-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a42a9b5c13231d2032ba2189a96153c01">fill_alloc_digest</a>(bv_blocks);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>            <a class="code" href="bm_8h.html#ad9736d9521d713fa5d48859aa720bfdd">BM_DECLARE_TEMP_BLOCK</a>(tb)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>            bv_blocks.optimize(tb);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>        }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span><span class="comment"></span> </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span><span class="comment">    /// Reset and build vector of references from a basic bit-matrix</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span><span class="comment">    ///  all NULL rows are skipped, not added to the ref.vector</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span><span class="comment">    /// @sa add_vectors</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span><span class="comment"></span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> BMATR&gt;</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#aa3a6cd0392fbfd9c6125f22f0ef55b7c">  716</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#aa3a6cd0392fbfd9c6125f22f0ef55b7c">build</a>(<span class="keyword">const</span> BMATR&amp; bmatr)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>    {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a99b7a8a3de7a6f72ca28499c5bec59a6">reset</a>();</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a30788ff14aaeded05308f63da184e653">add_vectors</a>(bmatr);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>    }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span><span class="comment"></span> </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span><span class="comment">    /// Append basic bit-matrix to the list of reference vectors</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span><span class="comment">    /// @sa build</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span><span class="comment">    /// @sa add_sparse_vector</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span><span class="comment"></span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> BMATR&gt;</div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a30788ff14aaeded05308f63da184e653">  726</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a30788ff14aaeded05308f63da184e653">add_vectors</a>(<span class="keyword">const</span> BMATR&amp; bmatr)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>    {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> rows = bmatr.rows();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>        <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> r = 0; r &lt; rows; ++r)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>            <span class="keywordflow">if</span> (<a class="code" href="classbm_1_1bv__ref__vector.html#a7da407ddf3f5ac59b1702ae236d85ce8">bvector_type_const_ptr</a> bv = bmatr.get_row(r))</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>                <a class="code" href="classbm_1_1bv__ref__vector.html#a7fb37bd870f784e018a684dd82b78165">add</a>(bv, <a class="code" href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">rows_acc_</a> + r);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">rows_acc_</a> += unsigned(rows);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>    }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span><span class="comment"></span> </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span><span class="comment">    /// Add bit-transposed sparse vector as a bit-matrix</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span><span class="comment">    /// @sa add_vectors</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span><span class="comment"></span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> SV&gt;</div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#ae7fbf468f1e47b998f5403c8e5fc2043">  739</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#ae7fbf468f1e47b998f5403c8e5fc2043">add_sparse_vector</a>(<span class="keyword">const</span> SV&amp; sv)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>    {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a30788ff14aaeded05308f63da184e653">add_vectors</a>(sv.get_bmatrix());</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span><span class="comment"></span> </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span><span class="comment">    /** Utility function to resize matrix based on number of vectors and blocks</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span><span class="comment">    */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#adb18ffdc8b1caea62b63340366130e29">  746</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1bv__ref__vector.html#adb18ffdc8b1caea62b63340366130e29">resize_xor_matrix</a>(<a class="code" href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">matrix_chain_type</a>&amp; matr,</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>                           <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> total_blocks)<span class="keyword"> const</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span><span class="keyword">    </span>{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>        <span class="keywordflow">if</span> (total_blocks)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>            matr.resize(<a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>.size(), total_blocks, <span class="keyword">false</span> <span class="comment">/*no-copy*/</span>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>            matr.resize(0, 0);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span><span class="comment"></span> </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span><span class="comment">    /** Calculate blocks digest and resize XOR distance matrix</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span><span class="comment">        based on total number of available blocks</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span><span class="comment">        @return true if created ok (false if no blocks found)</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span><span class="comment">     */</span></div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a6e52a29dee546e737e320a0daee784b9">  759</a></span>    <span class="keywordtype">bool</span> <a class="code" href="classbm_1_1bv__ref__vector.html#a6e52a29dee546e737e320a0daee784b9">build_nb_digest_and_xor_matrix</a>(<a class="code" href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">matrix_chain_type</a>&amp; matr,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>                                        <a class="code" href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bvector_type</a>&amp; bv_blocks)<span class="keyword"> const</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span><span class="keyword">    </span>{</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a42a9b5c13231d2032ba2189a96153c01">fill_alloc_digest</a>(bv_blocks);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">size_type</a> cnt = bv_blocks.count();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>        <span class="keywordflow">if</span> (!cnt)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>        <a class="code" href="classbm_1_1bv__ref__vector.html#adb18ffdc8b1caea62b63340366130e29">resize_xor_matrix</a>(matr, cnt);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span><span class="keyword">protected</span>:</div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#ad745dbd3f51f287af2f1e390347f4ec1">  771</a></span>    <span class="keyword">typedef</span> bm::heap_vector&lt;bvector_type_const_ptr, bv_allocator_type, true&gt; <a class="code" href="classbm_1_1bv__ref__vector.html#ad745dbd3f51f287af2f1e390347f4ec1">bvptr_vector_type</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#a456f5791cc81ee1b089200f3b0b14181">  772</a></span>    <span class="keyword">typedef</span> bm::heap_vector&lt;std::size_t, bv_allocator_type, true&gt; <a class="code" href="classbm_1_1bv__ref__vector.html#a456f5791cc81ee1b089200f3b0b14181">bv_plane_vector_type</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span><span class="keyword">protected</span>:</div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">  775</a></span>    <span class="keywordtype">unsigned</span>                 <a class="code" href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">rows_acc_</a> = 0;     <span class="comment">///&lt; total rows accumulator</span></div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">  776</a></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#ad745dbd3f51f287af2f1e390347f4ec1">bvptr_vector_type</a>        <a class="code" href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">ref_bvects_</a>;       <span class="comment">///&lt; reference vector pointers</span></div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">  777</a></span>    <a class="code" href="classbm_1_1bv__ref__vector.html#a456f5791cc81ee1b089200f3b0b14181">bv_plane_vector_type</a>     <a class="code" href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">ref_bvects_rows_</a>;  <span class="comment">///&lt; reference vector row idxs</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>};</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span><span class="comment">//</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span><span class="comment"></span> </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span><span class="comment">/**</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span><span class="comment">    XOR similarity model</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span><span class="comment"></span> </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span><span class="comment">*/</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html">  790</a></span><span class="keyword">struct </span><a class="code" href="structbm_1_1xor__sim__model.html">xor_sim_model</a></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>{</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#a7b61f5f9739fafab6cb9fd52590b2ece">  793</a></span>    <span class="keyword">typedef</span> BV                                          <a class="code" href="structbm_1_1xor__sim__model.html#a7b61f5f9739fafab6cb9fd52590b2ece">bvector_type</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#a6dc4b43d74e8c7f27ea85c4515381981">  794</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#a7fea809653a2792c84fd10c92b5c47c4">bvector_type::size_type</a>            <a class="code" href="structbm_1_1xor__sim__model.html#a6dc4b43d74e8c7f27ea85c4515381981">size_type</a>;</div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#ae9dcfb48df6abb8975b0de0033c0aacd">  795</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#ad1dbe63690fd5cd2b1e064795d3f1b6c">bvector_type::allocator_type</a>       <a class="code" href="structbm_1_1xor__sim__model.html#ae9dcfb48df6abb8975b0de0033c0aacd">bv_allocator_type</a>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#a65e172b4611d9d1abe882a980f9fe6b6">  798</a></span>    <span class="keyword">typedef</span> <a class="code" href="structbm_1_1block__match__chain.html">bm::block_match_chain&lt;size_type&gt;</a>            <a class="code" href="structbm_1_1xor__sim__model.html#a65e172b4611d9d1abe882a980f9fe6b6">block_match_chain_type</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>    <span class="keyword">typedef</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>    bm::dynamic_heap_matrix&lt;block_match_chain_type, bv_allocator_type&gt;</div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">  801</a></span>                                                             <a class="code" href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">matrix_chain_type</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#acb59c04ee2c395077d529d662f210feb">  804</a></span>    <a class="code" href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">matrix_chain_type</a>  <a class="code" href="structbm_1_1xor__sim__model.html#acb59c04ee2c395077d529d662f210feb">matr</a>; <span class="comment">///&lt; model matrix</span></div>
<div class="line"><a name="l00805"></a><span class="lineno"><a class="line" href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">  805</a></span>    <a class="code" href="structbm_1_1xor__sim__model.html#a7b61f5f9739fafab6cb9fd52590b2ece">bvector_type</a>       <a class="code" href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">bv_blocks</a>;  <span class="comment">///&lt; blocks digest</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>};</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span><span class="comment">//</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span><span class="comment"></span> </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span><span class="comment">/**</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span><span class="comment">    XOR scanner to search for complement-similarities in</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span><span class="comment">    collections of bit-vectors</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span><span class="comment"></span> </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span><span class="comment">    @internal</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span><span class="comment">*/</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html">  819</a></span><span class="keyword">class </span><a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>{</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a090167083a2ac17faaa98bbb35b7576c">  822</a></span>    <span class="keyword">typedef</span> <a class="code" href="classbm_1_1bv__ref__vector.html">bm::bv_ref_vector&lt;BV&gt;</a>                 <a class="code" href="classbm_1_1xor__scanner.html#a090167083a2ac17faaa98bbb35b7576c">bv_ref_vector_type</a>;</div>
<div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ac76bf3e9d94d83388f940bbd0ff24890">  823</a></span>    <span class="keyword">typedef</span> BV                                    <a class="code" href="classbm_1_1xor__scanner.html#ac76bf3e9d94d83388f940bbd0ff24890">bvector_type</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a674e2bed6302843d1351fe42a7c01e89">  824</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#ad1dbe63690fd5cd2b1e064795d3f1b6c">bvector_type::allocator_type</a> <a class="code" href="classbm_1_1xor__scanner.html#a674e2bed6302843d1351fe42a7c01e89">bv_allocator_type</a>;</div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">  825</a></span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector.html#a7fea809653a2792c84fd10c92b5c47c4">bvector_type::size_type</a>      <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span> </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>    <span class="keyword">typedef</span> bm::heap_vector&lt;bm::block_xor_match_descr, bv_allocator_type, true&gt;</div>
<div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a8799f4a72e999334c5de82d99437d3c2">  828</a></span>            <a class="code" href="classbm_1_1xor__scanner.html#a8799f4a72e999334c5de82d99437d3c2">xor_matches_vector_type</a>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>    <span class="keyword">typedef</span> bm::heap_vector&lt;bm::match_pair, bv_allocator_type, true&gt;</div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">  830</a></span>            <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">bv_ref_vector_type::matrix_chain_type</a></div>
<div class="line"><a name="l00832"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a7e16e0565419864210134fd297089aef">  832</a></span>                                                    <a class="code" href="classbm_1_1xor__scanner.html#a7e16e0565419864210134fd297089aef">matrix_chain_type</a>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>    <span class="keyword">typedef</span> bm::heap_vector&lt;bm::word_t*, bv_allocator_type, true&gt;</div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#af930cb73151f6a1fa248bd46a3b6940a">  834</a></span>                                                    <a class="code" href="classbm_1_1xor__scanner.html#af930cb73151f6a1fa248bd46a3b6940a">bv_blocks_vector_type</a>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>    <span class="keyword">typedef</span> bm::heap_vector&lt;unsigned, bv_allocator_type, true&gt;</div>
<div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a0c178a345699fd2eaed95fd7e2325de5">  836</a></span>                                                    <a class="code" href="classbm_1_1xor__scanner.html#a0c178a345699fd2eaed95fd7e2325de5">bv_bcgc_vector_type</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span> </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>    <span class="keyword">typedef</span> bm::heap_vector&lt;bm::block_waves_xor_descr, bv_allocator_type, true&gt;</div>
<div class="line"><a name="l00839"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#aaaf5d137f66ee3d80bb9d3354879e6ca">  839</a></span>                                                    <a class="code" href="classbm_1_1xor__scanner.html#aaaf5d137f66ee3d80bb9d3354879e6ca">bv_xdescr_vector_type</a>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span><span class="keyword">public</span>:</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ae6ce31b2065b0b68ba366335fca399f4">  843</a></span>    <a class="code" href="classbm_1_1xor__scanner.html#ae6ce31b2065b0b68ba366335fca399f4">xor_scanner</a>() {}</div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a84d854e3af0d858917ee9ec449fc837f">  844</a></span>    <a class="code" href="classbm_1_1xor__scanner.html#a84d854e3af0d858917ee9ec449fc837f">~xor_scanner</a>()</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>    {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>        <a class="code" href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96">free_blocks</a>();</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>    }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span> </div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ae901352e9450d01beac93a20a48cb7d5">  850</a></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#ae901352e9450d01beac93a20a48cb7d5">set_ref_vector</a>(<span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html">bv_ref_vector_type</a>* ref_vect) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>    { ref_vect_ = ref_vect; }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span> </div>
<div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#aadb5803354a0d483aec46eb65edc5e28">  853</a></span>    <span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html">bv_ref_vector_type</a>&amp; <a class="code" href="classbm_1_1xor__scanner.html#aadb5803354a0d483aec46eb65edc5e28">get_ref_vector</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>    { <span class="keywordflow">return</span> *ref_vect_; }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span><span class="comment"></span> </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span><span class="comment">    /** Get statistics for the r-(or s-) block</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span><span class="comment">        @param ri - nb cache index</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span><span class="comment">    */</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a2c60e5f0741c2f5571e3b8ec05289912">get_s_block_stats</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span><span class="comment"></span> </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span><span class="comment">    /** Compute statistics for the r-(or s-) block</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span><span class="comment">        @param block - bit-block target</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span><span class="comment">    */</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a8c81222aa192ce1f0a4fce162c98dee8">compute_s_block_stats</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* block) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span><span class="comment"></span> </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span><span class="comment">    /** Scan for all candidate bit-blocks to find mask or match</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span><span class="comment">        @return XOR referenece match type</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span><span class="comment">    */</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>    <a class="code" href="classbm_1_1xor__scanner.html#a1ae26d727b369930dcf92a70b4f30e95">search_best_xor_mask</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* s_block,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>                              <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri,</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>                              <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ridx_from,</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>                              <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ridx_to,</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>                              <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j,</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>                              <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* tx_block,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>                              <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params);<span class="comment"></span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span><span class="comment">        Run a search to add possible XOR match chain additions</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span><span class="comment">     */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> <a class="code" href="classbm_1_1xor__scanner.html#a5e47d6b287b0cc1d02deb3f99dfcfa0e">refine_match_chain</a>();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span><span class="comment"></span> </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span><span class="comment">        XOR all match blocks to target using their digest masks</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span><span class="comment">     */</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#ae45de6535b600285791f595e8fa13b59">apply_xor_match_vector</a>(</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>                       <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* target_xor_block,</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>                       <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* s_block,</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>                       <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> s_ri,</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>                       <span class="keyword">const</span> <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>&amp; pm_vect,</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>                       <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span><span class="comment"></span> </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span><span class="comment">        Calculate matrix of best XOR match metrics per block</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span><span class="comment">        for the attached collection of bit-vectors</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span><span class="comment">        @return true if computed successfully</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span><span class="comment">     */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>    <span class="keywordtype">bool</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">compute_sim_model</a>(<a class="code" href="structbm_1_1xor__sim__model.html">xor_sim_model&lt;BV&gt;</a>&amp;        sim_model,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>                           <span class="keyword">const</span> <a class="code" href="classbm_1_1xor__scanner.html#a090167083a2ac17faaa98bbb35b7576c">bv_ref_vector_type</a>&amp; ref_vect,</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>                           <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span><span class="comment"></span> </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span><span class="comment">        Calculate matrix of best XOR match metrics per block</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span><span class="comment">        for the attached collection of bit-vectors</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span><span class="comment">        @return true if computed successfully</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span><span class="comment">     */</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>    <span class="keywordtype">bool</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">compute_sim_model</a>(<a class="code" href="structbm_1_1xor__sim__model.html">xor_sim_model&lt;BV&gt;</a> &amp;sim_model,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>                           <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span><span class="comment"></span> </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span><span class="comment">        Compute similarity model for block</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span><span class="comment">     */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">compute_sim_model</a>(</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>        <span class="keyword">typename</span> <a class="code" href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">xor_sim_model&lt;BV&gt;::matrix_chain_type</a> &amp;sim_model_matr,</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>                           <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>                 nb,</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>                           <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>                 nb_rank,</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>                           <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params);<span class="comment"></span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span><span class="comment">        Compute reference complexity descriptor based on XOR vector.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span><span class="comment">        Returns the digest of sub-blocks where XOR filtering improved the metric</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span><span class="comment">        (function needs reference to estimate the improvement).</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span><span class="comment"></span> </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span><span class="comment">        part of Phase 2 of the XOR filtering process</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span><span class="comment"></span> </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span><span class="comment">        @sa compute_sub_block_complexity_descr</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span><span class="comment"></span> </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span><span class="comment">        @internal</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span><span class="comment">    */</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#ae8b7b41cdcfe827ee6b89ff8781f09c4">compute_xor_complexity_descr</a>(</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>                <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a>          block,</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>                <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>                            block_d64,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>                <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a>          xor_block,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>                <a class="code" href="structbm_1_1block__waves__xor__descr.html">bm::block_waves_xor_descr</a>&amp; <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> x_descr,</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>                <a class="code" href="structbm_1_1block__xor__match__descr.html">bm::block_xor_match_descr</a>&amp; <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xmd) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span><span class="comment"></span> </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span><span class="comment">    /**</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span><span class="comment">        Check if XOR transform simplified block enough for</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span><span class="comment">        compressibility objective</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span><span class="comment">     */</span></div>
<div class="line"><a name="l00940"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a2158dbdf98829c65cc6a887ee0632a33">  940</a></span>    <span class="keywordtype">bool</span> <a class="code" href="classbm_1_1xor__scanner.html#a2158dbdf98829c65cc6a887ee0632a33">validate_xor</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* xor_block) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span> </div>
<div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#acd129f61af747435fb452c0250148fde">  942</a></span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> <a class="code" href="classbm_1_1xor__scanner.html#acd129f61af747435fb452c0250148fde">found_ridx</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> found_ridx_; }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span><span class="comment"></span> </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span><span class="comment">    /// Return best match type of a found block</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00946"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#aa86e57ed4a80216bb4a4f51042c49415">  946</a></span><span class="comment"></span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a> <a class="code" href="classbm_1_1xor__scanner.html#aa86e57ed4a80216bb4a4f51042c49415">get_best_match_type</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>        {   <span class="keywordflow">return</span> x_block_mtype_; }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#af1ca6bb7d544b193d32b9541742ad075">  949</a></span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="classbm_1_1xor__scanner.html#af1ca6bb7d544b193d32b9541742ad075">get_found_block</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>        { <span class="keywordflow">return</span> found_block_xor_; }</div>
<div class="line"><a name="l00951"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a1ca43839153238d641db3888c728d4f7">  951</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classbm_1_1xor__scanner.html#a1ca43839153238d641db3888c728d4f7">get_x_best_metric</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> x_best_metric_; }</div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a60143e88fb9decae4a94952083370e1a">  952</a></span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> <a class="code" href="classbm_1_1xor__scanner.html#a60143e88fb9decae4a94952083370e1a">get_xor_digest</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> x_d64_; }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span> </div>
<div class="line"><a name="l00954"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a7a7d1141fbcd94f8e1df0376a0a34955">  954</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classbm_1_1xor__scanner.html#a7a7d1141fbcd94f8e1df0376a0a34955">get_s_bc</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> s_bc_; }</div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a0216b9d4c0e68d30092b703966d2ecb9">  955</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classbm_1_1xor__scanner.html#a0216b9d4c0e68d30092b703966d2ecb9">get_s_gc</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> s_gc_; }</div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">  956</a></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">get_s_block_best</a>() const <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>                    { <span class="keywordflow">return</span> s_block_best_metric_; }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a897b8cfd4f2da327e10ff5f6b6864f81">  960</a></span>    <a class="code" href="structbm_1_1block__waves__xor__descr.html">bm::block_waves_xor_descr</a>&amp; <a class="code" href="classbm_1_1xor__scanner.html#a897b8cfd4f2da327e10ff5f6b6864f81">get_descr</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a> { <span class="keywordflow">return</span> x_descr_; }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>    <span class="keyword">static</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a> <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(<span class="keywordtype">unsigned</span> bc, <span class="keywordtype">unsigned</span> gc,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>                                        <span class="keywordtype">unsigned</span>* <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a name="l00966"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a2f568a5891ed262156ec7283b6d5528a">  966</a></span>    <a class="code" href="classbm_1_1xor__scanner.html#a8799f4a72e999334c5de82d99437d3c2">xor_matches_vector_type</a>&amp; <a class="code" href="classbm_1_1xor__scanner.html#a2f568a5891ed262156ec7283b6d5528a">get_match_vector</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>        { <span class="keywordflow">return</span> match_vect_; }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span> </div>
<div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a55958d5cba850206b8ecb5b55d9c671d">  969</a></span>    <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>&amp; <a class="code" href="classbm_1_1xor__scanner.html#a55958d5cba850206b8ecb5b55d9c671d">get_match_pairs</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>        { <span class="keywordflow">return</span> chain_match_vect_; }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span><span class="comment"></span> </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span><span class="comment">    /// Return block from the reference vector [vect_idx, block_i, block_j]</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">  974</a></span><span class="comment"></span>    <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri,</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>                                    <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>    { <span class="keywordflow">return</span> ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a8a243086235da1b0d79143e293468463">get_bv</a>(ri)-&gt;get_blocks_manager().get_block_ptr(i, j); }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span><span class="comment"></span> </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span><span class="comment">    /// Sync TEMP vector size</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span><span class="comment">    /// @internal</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a14248c41706e978896cfe97bdc99c80a">sync_nb_vect</a>();</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span><span class="keyword">protected</span>:</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span><span class="comment"></span> </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span><span class="comment">    /// Deoptimize vertical slice of GAP blocks</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span><span class="comment">    /// @param nb - block number</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span><span class="comment">    ///</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a82016728a3071d7f0e06c1355a8a356f">deoptimize_gap_blocks</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> nb,</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>                               <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">xor_sim_params</a>&amp; params);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span><span class="comment"></span> </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span><span class="comment">    /// Free the collection of temp blocks</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span><span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96">free_blocks</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span> </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>private:</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>    <a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a>(const <a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a>&amp;) = delete;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>    <a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a>&amp; operator=(const <a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a>&amp;) = delete;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span> </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>private:</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>    <a class="code" href="bm_8h.html#ad9736d9521d713fa5d48859aa720bfdd">BM_DECLARE_TEMP_BLOCK</a>(xor_tmp_block_)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span> </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>    const <a class="code" href="classbm_1_1xor__scanner.html#a090167083a2ac17faaa98bbb35b7576c">bv_ref_vector_type</a>*   ref_vect_ = 0; <span class="comment">///&lt; ref.vect for XOR filter</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>    <a class="code" href="classbm_1_1xor__scanner.html#af930cb73151f6a1fa248bd46a3b6940a">bv_blocks_vector_type</a>       nb_blocks_vect_;   <span class="comment">///&lt; pointers to temp blocks</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>    <a class="code" href="classbm_1_1xor__scanner.html#a0c178a345699fd2eaed95fd7e2325de5">bv_bcgc_vector_type</a>         nb_gc_vect_;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>    <a class="code" href="classbm_1_1xor__scanner.html#a0c178a345699fd2eaed95fd7e2325de5">bv_bcgc_vector_type</a>         nb_bc_vect_;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>    <a class="code" href="classbm_1_1xor__scanner.html#aaaf5d137f66ee3d80bb9d3354879e6ca">bv_xdescr_vector_type</a>       nb_xdescr_vect_;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span> </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>    <a class="code" href="classbm_1_1xor__scanner.html#a674e2bed6302843d1351fe42a7c01e89">bv_allocator_type</a>           alloc_;            <span class="comment">///&lt; allocator to produce blocks</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span> </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>    <a class="code" href="namespacebm.html">bm</a>::<a class="code" href="structbm_1_1block__waves__xor__descr.html">block_waves_xor_descr</a>        x_descr_;  <span class="comment">///&lt; XOR desriptor</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>    <span class="comment">// S-block statistics</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>    <span class="keywordtype">unsigned</span>                      s_bc_;     <span class="comment">///&lt; bitcount</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>    <span class="keywordtype">unsigned</span>                      s_gc_;     <span class="comment">///&lt; gap count</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>    <span class="keywordtype">unsigned</span>                      s_block_best_metric_; <span class="comment">///&lt; s-block orig.metric</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>    <span class="keywordtype">unsigned</span>                      x_best_metric_; <span class="comment">///&lt; min(gc, bc, ibc)</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>    <a class="code" href="namespacebm.html">bm</a>::<a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">xor_complement_match</a>      x_block_mtype_; <span class="comment">///&lt; metric type</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span> </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>    <span class="comment">// scan related metrics</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>    <a class="code" href="namespacebm.html">bm</a>::<a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">id64_t</a>                    x_d64_;        <span class="comment">///&lt; search digest</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>                     found_ridx_;   <span class="comment">///&lt; match vector (in references)</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>    const <a class="code" href="namespacebm.html">bm</a>::<a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">word_t</a>*             found_block_xor_;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span> </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>    <span class="comment">// match chain members:</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>    <a class="code" href="classbm_1_1xor__scanner.html#a8799f4a72e999334c5de82d99437d3c2">xor_matches_vector_type</a>       match_vect_; <span class="comment">///&lt; vector of match descr</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>    <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>       chain_match_vect_; <span class="comment">///&lt; refined match pairs</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>};</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span><span class="comment">//</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span><span class="comment">//</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span><span class="comment">//  Naming conventions and glossary:</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span><span class="comment">//</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span><span class="comment">//  s_block - source serialization block to be XOR filtered (anchor block)</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span><span class="comment">//  best_ref_block - best reference block picked for XOR transform</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span><span class="comment">//  xt_block - s_block XOR best_ref_block</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span><span class="comment">//</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span> </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span> </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span> </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>template&lt;typename BV&gt;</div>
<div class="line"><a name="l01045"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a2c60e5f0741c2f5571e3b8ec05289912"> 1045</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html">xor_scanner</a>&lt;BV&gt;::<a class="code" href="classbm_1_1xor__scanner.html#a2c60e5f0741c2f5571e3b8ec05289912">get_s_block_stats</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>{</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>    x_descr_ = nb_xdescr_vect_[ri];</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>    s_gc_ = nb_gc_vect_[ri];</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>    s_bc_ = nb_bc_vect_[ri];</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>    x_block_mtype_ = <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(s_bc_, s_gc_, &amp;s_block_best_metric_);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>    x_best_metric_ = s_block_best_metric_;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>}</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span> </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01057"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a8c81222aa192ce1f0a4fce162c98dee8"> 1057</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a8c81222aa192ce1f0a4fce162c98dee8">xor_scanner&lt;BV&gt;::compute_s_block_stats</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* block) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>{</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(<a class="code" href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a>(block));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(!<a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(block));</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span> </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>    <a class="code" href="namespacebm.html#a34977fdaa1b6fc8dc9951bc7eba98ea6">bm::compute_s_block_descr</a>(block, x_descr_, &amp;s_gc_, &amp;s_bc_);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>    x_block_mtype_ = <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(s_bc_, s_gc_, &amp;s_block_best_metric_);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>    x_best_metric_ = s_block_best_metric_;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>}</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01070"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ae8b7b41cdcfe827ee6b89ff8781f09c4"> 1070</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#ae8b7b41cdcfe827ee6b89ff8781f09c4">xor_scanner&lt;BV&gt;::compute_xor_complexity_descr</a>(</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>                <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> block,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>                <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>                   block_d64,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>                <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xor_block,</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>                <a class="code" href="structbm_1_1block__waves__xor__descr.html">bm::block_waves_xor_descr</a>&amp; <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> x_descr,</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>                <a class="code" href="structbm_1_1block__xor__match__descr.html">bm::block_xor_match_descr</a>&amp; <a class="code" href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a> xmd) <span class="keyword">const</span>  <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>{</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d0 = ~~block_d64;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>    xmd.xor_gc = xmd.xor_bc = 0;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>    <span class="comment">// Pass 1: compute XOR descriptors</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>; ++i)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>    {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>        <span class="keywordtype">unsigned</span> off = (i * <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* sub_block = block + off;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* xor_sub_block = xor_block + off;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>        <span class="keywordtype">unsigned</span> xor_gc, xor_bc;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>        <a class="code" href="namespacebm.html#afddbb0034ce383a1fc2693196c472c81">bm::bit_block_xor_change</a>(sub_block, xor_sub_block,</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>                                 <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a>,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>                                 &amp;xor_gc, &amp;xor_bc);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>        x_descr.sb_xor_bc[i] = (<span class="keywordtype">unsigned</span> short)xor_bc;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(xor_gc);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>        <span class="keywordflow">if</span> (i) <span class="comment">// wave border correction</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>        {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a> w_l = (sub_block[-1] ^ xor_sub_block[-1]);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a> w_r = (sub_block[0] ^ xor_sub_block[0]) &amp; 1;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>            w_l &gt;&gt;= 31;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>            xor_gc -= (w_l == w_r);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>        }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>        x_descr.sb_xor_gc[i] = (<span class="keywordtype">unsigned</span> short)xor_gc;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>        xmd.xor_bc += xor_bc;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>        xmd.xor_gc += xor_gc;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>    <span class="comment">// Pass 2: find the best match</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>    <span class="keywordtype">unsigned</span> block_gc_gain(0), block_bc_gain(0), block_ibc_gain(0);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> gc_digest(0), bc_digest(0), ibc_digest(0);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> wave_max_bits = <a class="code" href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a> * 32;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span> </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>; ++i)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>    {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>        <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> dmask = (1ull &lt;&lt; i);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>        <span class="keywordflow">if</span> (d0 &amp; dmask)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span> </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>        <span class="keywordtype">unsigned</span> xor_gc = x_descr.sb_xor_gc[i];</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>        <span class="keywordflow">if</span> (xor_gc &lt;= 1)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>        {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>            gc_digest |= dmask;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>            block_gc_gain += x_descr.sb_gc[i]; <span class="comment">// all previous GAPs are gone</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xor_gc &lt; x_descr.sb_gc[i]) <span class="comment">// some improvement in GAPs</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>        {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>            gc_digest |= dmask;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>            block_gc_gain += (x_descr.sb_gc[i] - xor_gc);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>        }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>        <span class="keywordtype">unsigned</span> xor_bc = x_descr.sb_xor_bc[i];</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>        <span class="keywordflow">if</span> (xor_bc &lt; x_descr.sb_bc[i]) <span class="comment">// improvement in BITS</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>        {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>            bc_digest |= dmask;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>            block_bc_gain += (x_descr.sb_bc[i] - xor_bc);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>        }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>        <span class="keywordtype">unsigned</span> xor_ibc = wave_max_bits - xor_bc;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>        <span class="keywordtype">unsigned</span> wave_ibc = wave_max_bits - x_descr.sb_bc[i];</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>        <span class="keywordflow">if</span> (xor_ibc &lt; wave_ibc) <span class="comment">// improvement in 0 BITS</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>        {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>            ibc_digest |= dmask;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>            block_ibc_gain += (wave_ibc - xor_ibc);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>        }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>    } <span class="comment">// for i</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span> </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>    <span class="comment">// Save metric results into XOR match descriptor</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span> </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>    xmd.gc_d64 = gc_digest;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>    xmd.bc_d64 = bc_digest;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>    xmd.ibc_d64 = ibc_digest;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>    xmd.gc_gain = block_gc_gain;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>    xmd.bc_gain = block_bc_gain;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>    xmd.ibc_gain = block_ibc_gain;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span> </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span> </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>    <span class="comment">// Find the winning metric and its digest mask</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>    <span class="keywordflow">if</span> (!(block_gc_gain | block_bc_gain | block_ibc_gain)) <span class="comment">// match not found</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>    {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>        <span class="comment">// this is to check if xor filter has</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>        <span class="comment">// canceled out a whole sub-block wave</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>        <span class="comment">//</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>        <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d0_x = ~<a class="code" href="namespacebm.html">~bm</a><a class="code" href="group__bitfunc.html#ga903047d3a2578c8b512c6fc5896fa62d">::calc_block_digest0</a>(xor_block);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>        <span class="keywordflow">if</span> (d0 == d0_x)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>        {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>            xmd.match_type = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">bm::e_xor_match_GC</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>            xmd.block_gain = <a class="code" href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>            xmd.xor_d64 = d0;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>        }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>        xmd.match_type = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">bm::e_no_xor_match</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>        xmd.block_gain = 0; xmd.xor_d64 = 0;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>    }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>    <span class="keywordtype">int</span> new_gc = int(s_gc_) - int(block_gc_gain);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>    <span class="keywordflow">if</span> (new_gc &lt; 0)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>        new_gc = 0;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>    <span class="keywordtype">int</span> new_bc = int(s_bc_) - int(block_bc_gain);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>    <span class="keywordflow">if</span> (new_bc &lt; 0)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>        new_bc = 0;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>    <span class="keywordtype">int</span> new_ibc =  int(<a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a>) - int(s_bc_) - int(block_ibc_gain);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>    <span class="keywordflow">if</span> (new_ibc &lt; 0)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>        new_ibc = 0;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span> </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span> </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>    <span class="keywordtype">unsigned</span> best_m;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>    xmd.match_type = <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(<span class="keywordtype">unsigned</span>(new_bc), <span class="keywordtype">unsigned</span>(new_gc), &amp;best_m);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>    <span class="keywordflow">switch</span> (xmd.match_type)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>    {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>    <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">e_xor_match_GC</a>:</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>        <span class="keywordflow">if</span> (new_ibc &lt; new_gc)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>        {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>            xmd.block_gain = block_ibc_gain; xmd.xor_d64 = ibc_digest;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>        }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>        {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>            xmd.block_gain = block_gc_gain; xmd.xor_d64 = gc_digest;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>    <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">e_xor_match_BC</a>:</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>        <span class="keywordflow">if</span> (new_ibc &lt; new_bc)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>        {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>            xmd.block_gain = block_ibc_gain; xmd.xor_d64 = ibc_digest;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>        }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>        {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>            xmd.block_gain = block_bc_gain; xmd.xor_d64 = bc_digest;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>        }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">e_xor_match_iBC</a>:</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>        xmd.block_gain = block_ibc_gain; xmd.xor_d64 = ibc_digest;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>    } <span class="comment">// switch</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>    <span class="comment">// Disabled as cases compression ratio degradation in some tests</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>    <span class="keywordflow">if</span> (!xmd.xor_d64) <span class="comment">// best metric choice did not work try best gain</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>    {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>        <span class="keywordflow">if</span> (block_gc_gain &gt;= block_bc_gain &amp;&amp; block_gc_gain &gt;= block_ibc_gain)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>        {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>            xmd.block_gain = block_gc_gain; xmd.xor_d64 = gc_digest;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>        }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>        <span class="keywordflow">if</span> (block_bc_gain &gt; block_gc_gain &amp;&amp; block_bc_gain &gt; block_ibc_gain)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>        {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>            xmd.block_gain = block_bc_gain; xmd.xor_d64 = bc_digest;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>        }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>        {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>            xmd.block_gain = block_ibc_gain; xmd.xor_d64 = ibc_digest;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>        }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>    }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>}</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span> </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span> </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span><a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a></div>
<div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a1ae26d727b369930dcf92a70b4f30e95"> 1246</a></span><a class="code" href="classbm_1_1xor__scanner.html#a1ae26d727b369930dcf92a70b4f30e95">xor_scanner&lt;BV&gt;::search_best_xor_mask</a>(<span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* s_block,</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>                                       <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> s_ri,</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>                                       <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ridx_from,</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>                                       <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ridx_to,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>                                       <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j,</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>                                       <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* tx_block,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>                                       <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params)</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>{</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(ridx_from &lt;= ridx_to);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(<a class="code" href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a>(s_block));</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(tx_block);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span> </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>    <span class="keywordflow">if</span> (ridx_to &gt; ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>())</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>        ridx_to = ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span> </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a> rb_found = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d64 = 0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>    found_block_xor_ = 0;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>    <span class="keywordtype">unsigned</span> best_block_gain = 0;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>    <span class="keywordtype">int</span> best_ri = -1;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span> </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>    match_vect_.resize(0);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span> </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>    <span class="keywordtype">unsigned</span> s_gc(0);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>    <span class="keywordtype">bool</span> s_gap = <a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(s_block);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>    <span class="keywordflow">if</span> (s_gap)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>    {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#ac654d6319039a86546d235a236fc7cf6">bm::gap_word_t</a>* gap_s_block = <a class="code" href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a>(s_block);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>        s_gc = <a class="code" href="group__gapfunc.html#gae851a912a38bc6ef20e051a9e6ee099a">bm::gap_length</a>(gap_s_block);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>        <span class="keywordflow">if</span> (s_gc &lt;= 3)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>            <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>        s_block = nb_blocks_vect_.at(s_ri);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(s_block);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>    }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>    <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> s_block_d64 = <a class="code" href="group__bitfunc.html#ga903047d3a2578c8b512c6fc5896fa62d">bm::calc_block_digest0</a>(s_block);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span> </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>    <span class="comment">// scan pass: over reference vectors</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>    <span class="comment">//</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>    <span class="keywordflow">if</span> (ridx_to &gt; ridx_from + params.<a class="code" href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">max_lookup_depth</a>)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>        ridx_to = ridx_from + params.<a class="code" href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">max_lookup_depth</a>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span> </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> depth = 0;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri = ridx_from; ri &lt; ridx_to; ++ri, ++depth)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>    {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* ref_block = <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(ri, i, j);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>        <span class="keywordflow">if</span> (<a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(ref_block))</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>        {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#ac654d6319039a86546d235a236fc7cf6">bm::gap_word_t</a>* gap_ref_block = <a class="code" href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a>(ref_block);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>            <span class="keywordtype">unsigned</span> r_gc = <a class="code" href="group__gapfunc.html#gae851a912a38bc6ef20e051a9e6ee099a">bm::gap_length</a>(gap_ref_block);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>            <span class="keywordflow">if</span> (r_gc &lt;= 3)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span> </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>            <span class="keywordflow">if</span> (s_gap) <span class="comment">// both blocks GAPs - check if XOR does not make sense</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>            {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>                <span class="keywordflow">if</span> (s_gc &lt; r_gc) <span class="comment">// S-GAP block is shorter than Ref BLOCK</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>                {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>                    <span class="keywordtype">unsigned</span> gc_diff = r_gc - s_gc;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>                    <span class="keywordflow">if</span> (gc_diff &gt;= s_gc) <span class="comment">// cannot improve anything</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>                }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>            }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span> </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>            <span class="keywordflow">if</span> (nb_blocks_vect_.size() &gt; ri)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>                ref_block = nb_blocks_vect_[ri];</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>        }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>        <span class="keywordflow">if</span> (!<a class="code" href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a>(ref_block))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(s_block != ref_block);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span> </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>        <a class="code" href="structbm_1_1block__xor__match__descr.html">bm::block_xor_match_descr</a> xmd;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>        <a class="code" href="classbm_1_1xor__scanner.html#ae8b7b41cdcfe827ee6b89ff8781f09c4">compute_xor_complexity_descr</a>(s_block, s_block_d64, ref_block, x_descr_, xmd);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>        <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">xor_d64</a>) <span class="comment">// candidate XOR block found</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>        {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>            xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">ref_idx</a> = ri;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>            <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a>);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>            <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a> &gt; best_block_gain)</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>            {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>                <span class="comment">// check if &quot;it is good enough&quot;</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>                <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(x_best_metric_ &lt;= s_block_best_metric_);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>                best_block_gain = xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a>;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>                best_ri = int(ri);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>                d64 = xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">xor_d64</a>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>                <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a> &gt;= (<a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a>-3))</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>                <span class="keywordtype">unsigned</span> curr_best;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>                <span class="comment">//bm::xor_complement_match match =</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>                <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a4c65e8e6d0079b20d78ef17ec5ea50d8">xor_bc</a>, xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#a3a194d3e860da37c6e16755805574788">xor_gc</a>, &amp;curr_best);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>                <span class="keywordtype">float</span> gain_ratio =</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>                    float(xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a>) / float(s_block_best_metric_);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span> </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>                <span class="keywordflow">if</span> (depth &gt;= params.<a class="code" href="structbm_1_1xor__sim__params.html#a8ac8f9f08a60f991fd78708f67d19515">min_lookup_depth</a> &amp;&amp;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>                    x_block_mtype_ == xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">match_type</a>)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>                {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>                    <span class="keywordflow">if</span> (xmd.<a class="code" href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">block_gain</a> &gt;= params.<a class="code" href="structbm_1_1xor__sim__params.html#a777f9468e2cf75d79db603b35d59eaa2">stop_gain</a>)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>                    <span class="keywordflow">if</span> (gain_ratio &gt; params.<a class="code" href="structbm_1_1xor__sim__params.html#af9393fc7693813404eb2c9161f59c3d5">target_gain_ratio</a>)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>                }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>            }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>            match_vect_.push_back(xmd); <span class="comment">// place into vector of matches</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>        }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>    } <span class="comment">// for ri</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span> </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>    found_ridx_ = <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>(best_ri);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>    x_d64_ = d64;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span> </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>    <span class="keywordflow">if</span> (best_ri != -1) <span class="comment">// found some gain, validate it now</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>    {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>        <span class="comment">// assumed that if XOR compression c_level is at the highest</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> bie_bits_per_int = 3.0f; <span class="comment">// c_level_ &lt; 6 ? 3.75f : 3.0f;</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> bie_limit =</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>                unsigned(<span class="keywordtype">float</span>(<a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a>) / bie_bits_per_int);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span> </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>        <span class="keywordtype">unsigned</span> xor_bc, xor_gc;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* ref_block = <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>(best_ri), i, j);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>        <span class="keywordtype">bool</span> r_gap = <a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(ref_block);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>        <span class="keywordflow">if</span> (r_gap)</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>            ref_block = nb_blocks_vect_[<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>(best_ri)];</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>        found_block_xor_ = ref_block;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span> </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>        <span class="comment">// TODO: one pass operation?</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>        <a class="code" href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bm::bit_block_xor</a>(tx_block, s_block, ref_block, d64);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>        <a class="code" href="namespacebm.html#a0a024b52eb991e70a9fa9936f9b1ba40">bm::bit_block_change_bc</a>(tx_block, &amp;xor_gc, &amp;xor_bc);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span> </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>        <span class="keywordflow">if</span> (!xor_bc) <span class="comment">// check if completely identical block?</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>        {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>            x_best_metric_ = xor_bc;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>            found_ridx_ = <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>(best_ri);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>            x_block_mtype_ = rb_found = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">e_xor_match_BC</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span> </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>            <span class="keywordtype">unsigned</span> block_pos;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>            <span class="keywordtype">bool</span> found = <a class="code" href="namespacebm.html#a7158ed663405dd637ba68a475118a288">bm::block_find_first_diff</a>(s_block, ref_block, &amp;block_pos);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>            <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>            {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>                x_block_mtype_ = rb_found = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">e_xor_match_EQ</a>; x_d64_ = 0;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>            }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>        }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>        <span class="keywordflow">else</span> <span class="comment">// find the best matching metric (GC, BC, iBC, ..)</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>        {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>            rb_found = <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(xor_bc, xor_gc, &amp;x_best_metric_);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span> </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>            <span class="comment">// double check if XOR improves compression</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>            <span class="comment">// with accounted serialization overhead</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>            <span class="comment">//</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>            <span class="keywordflow">if</span> (rb_found)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>            {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>                <span class="keywordflow">if</span> (x_best_metric_ &gt; bie_limit ||</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>                    <a class="code" href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">get_s_block_best</a>() &lt; x_best_metric_)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>                    <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span> </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>                <span class="keywordtype">unsigned</span> gain = <a class="code" href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">get_s_block_best</a>() - x_best_metric_;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>                gain *= 3; <span class="comment">// use bit estimate (speculative)</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>                <span class="comment">// gain should be greater than overhead for storing</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>                <span class="comment">// reference data: xor token, digest-64, block idx</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>                <span class="keywordtype">unsigned</span> gain_min = unsigned(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>));</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>                <span class="keywordflow">if</span> (d64 != ~0ull) <span class="comment">// if mask is all 1s - it is not used</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>                    gain_min += (unsigned)<span class="keyword">sizeof</span>(<a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>                {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>                    <span class="keywordflow">if</span> (x_best_metric_ &lt;= 1)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>                        <span class="keywordflow">return</span> rb_found;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>                }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>                gain_min *= 8; <span class="comment">// in bits</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>                <span class="keywordflow">if</span> (gain &gt; gain_min)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>                    <span class="keywordflow">return</span> rb_found;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span> </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>                <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>            }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>        }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>    }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>    <span class="keywordflow">return</span> rb_found;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>}</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span> </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span> </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01425"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a5e47d6b287b0cc1d02deb3f99dfcfa0e"> 1425</a></span><span class="keyword">typename</span> <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">xor_scanner&lt;BV&gt;::size_type</a> <a class="code" href="classbm_1_1xor__scanner.html#a5e47d6b287b0cc1d02deb3f99dfcfa0e">xor_scanner&lt;BV&gt;::refine_match_chain</a>()</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>{</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> match_size = 0;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>    <span class="keywordflow">if</span> (x_d64_ == ~0ull || !x_d64_)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>        <span class="keywordflow">return</span> match_size;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>    <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a> mtype = <a class="code" href="classbm_1_1xor__scanner.html#aa86e57ed4a80216bb4a4f51042c49415">get_best_match_type</a>();</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>    match_size = (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>)</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>        <a class="code" href="namespacebm.html#a46a7c02fff53ca169e6482d4942f96f7">bm::greedy_refine_match_vector</a>(</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>            chain_match_vect_, match_vect_, found_ridx_, x_d64_, mtype);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>    <span class="keywordflow">return</span> match_size;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>}</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span> </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span> </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d"> 1440</a></span><span class="keywordtype">bool</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">xor_scanner&lt;BV&gt;::compute_sim_model</a>(<a class="code" href="structbm_1_1xor__sim__model.html">xor_sim_model&lt;BV&gt;</a> &amp;sim_model,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>                                        <span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html">bv_ref_vector_type</a>&amp; ref_vect,</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>                                        <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>{</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>    <span class="keyword">const</span> <a class="code" href="classbm_1_1bv__ref__vector.html">bv_ref_vector_type</a>* ref_vect_curr = this-&gt;ref_vect_; <span class="comment">// save ref-vect</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span> </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>    ref_vect_ = &amp;ref_vect;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>    <span class="keywordtype">bool</span> sim_ok = <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">compute_sim_model</a>(sim_model, params);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span> </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>    ref_vect_ = ref_vect_curr; <span class="comment">// restore state</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>    <span class="keywordflow">return</span> sim_ok;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>}</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span> </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ae77ce85a6918cdf3be575aa2c21b1a87"> 1454</a></span><span class="keywordtype">bool</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">xor_scanner&lt;BV&gt;::compute_sim_model</a>(<a class="code" href="structbm_1_1xor__sim__model.html">bm::xor_sim_model&lt;BV&gt;</a>&amp; sim_model,</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>                                        <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>{</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(ref_vect_);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>    sim_model.<a class="code" href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">bv_blocks</a>.clear(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>    <span class="keywordtype">bool</span> ret = ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a6e52a29dee546e737e320a0daee784b9">build_nb_digest_and_xor_matrix</a>(sim_model.<a class="code" href="structbm_1_1xor__sim__model.html#acb59c04ee2c395077d529d662f210feb">matr</a>,</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>                                                         sim_model.<a class="code" href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">bv_blocks</a>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>    <span class="keywordflow">if</span> (!ret)</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span> </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14248c41706e978896cfe97bdc99c80a">sync_nb_vect</a>();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span> </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>    <span class="keyword">typename</span> <a class="code" href="classbm_1_1bvector_1_1enumerator.html">bvector_type::enumerator</a> en(sim_model.<a class="code" href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">bv_blocks</a>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> col = 0; en.<a class="code" href="classbm_1_1bvector_1_1iterator__base.html#a3f6af7f5b46c0219b28916187d302c43">valid</a>(); ++en, ++col)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>    {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>        <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> nb = *en;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>        <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">compute_sim_model</a>(sim_model.<a class="code" href="structbm_1_1xor__sim__model.html#acb59c04ee2c395077d529d662f210feb">matr</a>, nb, col, params);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>    } <span class="comment">// for en</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>}</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span> </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span> </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01479"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#aa002d41e563d1dc1b5ce152b45a07c44"> 1479</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">xor_scanner&lt;BV&gt;::compute_sim_model</a>(</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>                <span class="keyword">typename</span> <a class="code" href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">xor_sim_model&lt;BV&gt;::matrix_chain_type</a> &amp;sim_model_matr,</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>                        <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>                 nb,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>                        <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a>                 nb_rank,</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>                        <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a>&amp; params)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>{</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(nb_rank &lt; sim_model_matr.cols());</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> bie_bits_per_int = 3.0f; <span class="comment">// c_level_ &lt; 6 ? 3.75f : 3.0f;</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> bie_limit =</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>            unsigned(<span class="keywordtype">float</span>(<a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a>) / bie_bits_per_int);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span> </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>    <a class="code" href="classbm_1_1xor__scanner.html#a82016728a3071d7f0e06c1355a8a356f">deoptimize_gap_blocks</a>(nb, params);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span> </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> rsize = ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span> </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>    <span class="keywordtype">unsigned</span> i0, j0;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>    <a class="code" href="namespacebm.html#a433a2db7a9c62fa1a31b85d80c311391">bm::get_block_coord</a>(nb, i0, j0);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span> </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri=0; <span class="keyword">true</span>; ++ri)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>    {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>        <a class="code" href="structbm_1_1block__match__chain.html">bm::block_match_chain&lt;size_type&gt;</a>* m_row = sim_model_matr.row(ri);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>        <a class="code" href="structbm_1_1block__match__chain.html">bm::block_match_chain&lt;size_type&gt;</a>&amp; bmc = m_row[nb_rank];</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>        bmc.<a class="code" href="structbm_1_1block__match__chain.html#a409849a3a91d76d8512918531d64680c">nb</a> = nb;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>        bmc.<a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a> = 0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>        bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span> </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>        <span class="keywordflow">if</span> (ri == rsize-1)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span> </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* s_block = <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(ri, i0, j0);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>        <span class="keywordflow">if</span> (!<a class="code" href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a>(s_block))</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span> </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>        <span class="keywordflow">if</span> (<a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(s_block))</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>        {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#ac654d6319039a86546d235a236fc7cf6">bm::gap_word_t</a>* gap_s_block = <a class="code" href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a>(s_block);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>            <span class="keywordtype">unsigned</span> gc = <a class="code" href="group__gapfunc.html#gae851a912a38bc6ef20e051a9e6ee099a">bm::gap_length</a>(gap_s_block);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>            <span class="keywordflow">if</span> (gc &lt;= params.<a class="code" href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">min_gaps</a>)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>        }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span> </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>        <span class="comment">// compute s-block best metrics</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>        <a class="code" href="classbm_1_1xor__scanner.html#a2c60e5f0741c2f5571e3b8ec05289912">get_s_block_stats</a>(ri);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>        <span class="keywordflow">if</span> (s_block_best_metric_ &lt; 3)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span> </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>        <span class="comment">// scan ref-vector plains for best similarity</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>        <span class="comment">//</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>        bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> = <a class="code" href="classbm_1_1xor__scanner.html#a1ae26d727b369930dcf92a70b4f30e95">search_best_xor_mask</a>(s_block, ri, ri+1, rsize,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>                                          i0, j0, xor_tmp_block_, params);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>        <span class="comment">// take index in the ref-vector (not translated to a plain number)</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>        <span class="comment">//</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>        <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ridx = <a class="code" href="classbm_1_1xor__scanner.html#acd129f61af747435fb452c0250148fde">found_ridx</a>();</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>        <a class="code" href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a> d64 = <a class="code" href="classbm_1_1xor__scanner.html#a60143e88fb9decae4a94952083370e1a">get_xor_digest</a>();</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span> </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>        <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> chain_size = 0;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>        <span class="keywordflow">if</span> (d64 &amp;&amp; d64 != ~0ULL) <span class="comment">// something found</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>        {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>            chain_size = <a class="code" href="classbm_1_1xor__scanner.html#a5e47d6b287b0cc1d02deb3f99dfcfa0e">refine_match_chain</a>();</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>        }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>        <span class="keywordflow">switch</span> (bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a>)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>        {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>        <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>:</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>            <span class="keywordflow">if</span> (chain_size) <span class="comment">// try chain compression for improve</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>            {</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>                <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>&amp; pm_vect = <a class="code" href="classbm_1_1xor__scanner.html#a55958d5cba850206b8ecb5b55d9c671d">get_match_pairs</a>();</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>                <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(chain_size == pm_vect.size());</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>                <a class="code" href="classbm_1_1xor__scanner.html#ae45de6535b600285791f595e8fa13b59">apply_xor_match_vector</a>(xor_tmp_block_,</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>                                       s_block, ri,</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>                                       pm_vect, i0, j0);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>                <span class="keywordtype">unsigned</span> xor_bc, xor_gc;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>                <a class="code" href="namespacebm.html#a0a024b52eb991e70a9fa9936f9b1ba40">bm::bit_block_change_bc</a>(xor_tmp_block_, &amp;xor_gc, &amp;xor_bc);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>                bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> = <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>(xor_bc, xor_gc, &amp;x_best_metric_);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>                <span class="keywordflow">if</span> (bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a>)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>                {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>                    <span class="keywordflow">if</span> ((x_best_metric_ &gt; bie_limit) ||</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>                        (<a class="code" href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">get_s_block_best</a>() &lt; x_best_metric_))</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>                    {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>                        bmc.<a class="code" href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">match</a> = <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">e_no_xor_match</a>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>                    }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>                    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> k = 0; k &lt; chain_size; ++k)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>                    {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>                        <span class="keyword">const</span> <a class="code" href="structbm_1_1match__pair.html">bm::match_pair</a>&amp; mp = pm_vect[k];</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>                        bmc.<a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[k] = (unsigned)mp.<a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>                        bmc.<a class="code" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">xor_d64</a>[k] = mp.<a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>                        bmc.<a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>++;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>                    } <span class="comment">// for k</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>                }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>            }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>        <span class="keywordflow">case</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">e_xor_match_EQ</a>:</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>            bmc.<a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>++;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>            bmc.<a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[0] = unsigned(ridx);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>        <span class="keywordflow">default</span>: <span class="comment">// improving match found</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>            bmc.<a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>++;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>            bmc.<a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[0] = unsigned(ridx);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>            bmc.<a class="code" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">xor_d64</a>[0] = d64;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span> </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>            <span class="keywordflow">if</span> (chain_size) <span class="comment">// match chain needs no verification</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>            {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>                <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>&amp; pm_vect = <a class="code" href="classbm_1_1xor__scanner.html#a55958d5cba850206b8ecb5b55d9c671d">get_match_pairs</a>();</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>                <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(chain_size == pm_vect.size());</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>                <span class="keyword">auto</span> sz = pm_vect.size();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>                <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> k = 0; k &lt; sz; ++k)</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>                {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>                    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(k &lt; 64);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>                    <span class="keyword">const</span> <a class="code" href="structbm_1_1match__pair.html">bm::match_pair</a>&amp; mp = pm_vect[k];</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>                    bmc.<a class="code" href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">ref_idx</a>[k+1] = (unsigned)mp.<a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>                    bmc.<a class="code" href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">xor_d64</a>[k+1] = mp.<a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>                    bmc.<a class="code" href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">chain_size</a>++;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>                } <span class="comment">// for k</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>            }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span> </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>        } <span class="comment">// switch</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span> </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>    } <span class="comment">// for ri</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>}</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span> </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span> </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span> </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#ae45de6535b600285791f595e8fa13b59"> 1607</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#ae45de6535b600285791f595e8fa13b59">xor_scanner&lt;BV&gt;::apply_xor_match_vector</a>(</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>                       <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* target_xor_block,</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>                       <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* s_block,</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>                       <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> s_ri,</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>                       <span class="keyword">const</span> <a class="code" href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">match_pairs_vector_type</a>&amp; pm_vect,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>                       <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j) <span class="keyword">const</span> <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>{</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>    <span class="keywordtype">bool</span> s_gap = <a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(s_block);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>    <span class="keywordflow">if</span> (s_gap)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>    {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>        s_block = nb_blocks_vect_.at(s_ri);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>        <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(s_block);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>    }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>    <span class="keyword">auto</span> sz = pm_vect.size();</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>    <span class="keywordflow">for</span> (<span class="keyword">typename</span> match_pairs_vector_type::size_type k = 0; k &lt; sz; ++k)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>    {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>        <span class="keyword">const</span> <a class="code" href="structbm_1_1match__pair.html">bm::match_pair</a>&amp; mp = pm_vect[k];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* ref_block = <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(mp.<a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>, i, j);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>        <span class="keywordflow">if</span> (<a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(ref_block))</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>        {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>            ref_block = nb_blocks_vect_[mp.<a class="code" href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">ref_idx</a>];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>            <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(ref_block);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>        }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>        <span class="keywordflow">if</span> (!k)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>            <a class="code" href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bm::bit_block_xor</a>(target_xor_block, s_block, ref_block, mp.<a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>            <a class="code" href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bm::bit_block_xor</a>(target_xor_block, ref_block, mp.<a class="code" href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">xor_d64</a>);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>    } <span class="comment">// for k</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>}</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span> </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span> </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span><a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a></div>
<div class="line"><a name="l01641"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b"> 1641</a></span><a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">xor_scanner&lt;BV&gt;::best_metric</a>(<span class="keywordtype">unsigned</span> bc, <span class="keywordtype">unsigned</span> gc,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>                             <span class="keywordtype">unsigned</span>* <a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>) <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>{</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(<a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a>);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>    <span class="keywordtype">unsigned</span> ibc = <a class="code" href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a> - bc;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>    <span class="keywordflow">if</span> (!ibc)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>    {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>        *<a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a> = gc;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>        <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">e_xor_match_GC</a>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>    }</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>    <span class="keywordflow">if</span> (gc &lt; bc) <span class="comment">// GC &lt; BC</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>    {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>        <span class="keywordflow">if</span> (gc &lt;= ibc)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>        {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>            *<a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a> = gc;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>            <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">e_xor_match_GC</a>;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>    }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>    <span class="keywordflow">else</span> <span class="comment">// GC &gt;= BC</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>    {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>        <span class="keywordflow">if</span> (bc &lt;= ibc)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>        {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>            *<a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a> = bc;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>            <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">e_xor_match_BC</a>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>        }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>    *<a class="code" href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">best_metric</a> = ibc;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>    <span class="keywordflow">return</span> <a class="code" href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">e_xor_match_iBC</a>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>}</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span> </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span> </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01675"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96"> 1675</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96">xor_scanner&lt;BV&gt;::free_blocks</a>() <a class="code" href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>{</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>    <span class="keywordtype">size_t</span> sz = nb_blocks_vect_.size();</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; sz; ++i)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>    {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>        <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* blk = nb_blocks_vect_[i];</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>        <span class="keywordflow">if</span> (blk)</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>            alloc_.free_bit_block(blk);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>    }</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>    nb_blocks_vect_.resize(0);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>}</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span> </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span> </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01690"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a82016728a3071d7f0e06c1355a8a356f"> 1690</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a82016728a3071d7f0e06c1355a8a356f">xor_scanner&lt;BV&gt;::deoptimize_gap_blocks</a>(<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> nb,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>                                    <span class="keyword">const</span> <a class="code" href="structbm_1_1xor__sim__params.html">xor_sim_params</a>&amp; params)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>{</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> rsize = ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>    <a class="code" href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a>(nb_blocks_vect_.size() == rsize);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>    <span class="keywordtype">unsigned</span> i0, j0;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>    <a class="code" href="namespacebm.html#a433a2db7a9c62fa1a31b85d80c311391">bm::get_block_coord</a>(nb, i0, j0);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span> </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> ri=0; ri &lt; rsize; ++ri)</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>    {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>        <span class="keyword">const</span> <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* block = <a class="code" href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">get_ref_block</a>(ri, i0, j0);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>        <span class="keywordflow">if</span> (<a class="code" href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a>(block))</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>        {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>            <span class="keyword">const</span> <a class="code" href="namespacebm.html#ac654d6319039a86546d235a236fc7cf6">bm::gap_word_t</a>* gap_block = <a class="code" href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a>(block);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>            <span class="keywordtype">unsigned</span> gc = <a class="code" href="group__gapfunc.html#gae851a912a38bc6ef20e051a9e6ee099a">bm::gap_length</a>(gap_block);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>            <span class="keywordflow">if</span> (gc &lt;= params.<a class="code" href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">min_gaps</a>)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span> </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>            <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>* t_block = nb_blocks_vect_.at(ri);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>            <span class="keywordflow">if</span> (!t_block)</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>            {</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>                t_block = alloc_.alloc_bit_block();</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>                nb_blocks_vect_[ri] = t_block;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>            }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>            <a class="code" href="group__gapfunc.html#ga46b1ef5db20451ece81c0a8324e035e3">bm::gap_convert_to_bitset</a>(t_block, <a class="code" href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a>(block));</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>            block = t_block;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>        }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>        <span class="keywordflow">if</span> (!<a class="code" href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a>(block))</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span> </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>        <a class="code" href="structbm_1_1block__waves__xor__descr.html">block_waves_xor_descr</a>&amp; x_descr = nb_xdescr_vect_[ri];</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>        <span class="keywordtype">unsigned</span> gc, bc;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>        <a class="code" href="namespacebm.html#a34977fdaa1b6fc8dc9951bc7eba98ea6">bm::compute_s_block_descr</a>(block, x_descr, &amp;gc, &amp;bc);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>        nb_gc_vect_[ri] = gc;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>        nb_bc_vect_[ri] = bc;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>    } <span class="comment">// for ri</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span> </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>}</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span> </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span> </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> BV&gt;</div>
<div class="line"><a name="l01732"></a><span class="lineno"><a class="line" href="classbm_1_1xor__scanner.html#a14248c41706e978896cfe97bdc99c80a"> 1732</a></span><span class="keywordtype">void</span> <a class="code" href="classbm_1_1xor__scanner.html#a14248c41706e978896cfe97bdc99c80a">xor_scanner&lt;BV&gt;::sync_nb_vect</a>()</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>{</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>    <a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> rsize = ref_vect_-&gt;<a class="code" href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">size</a>();</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>    <span class="keywordflow">if</span> (nb_blocks_vect_.size() == rsize)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>    <a class="code" href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96">free_blocks</a>();</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>    nb_blocks_vect_.resize(rsize);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>    <a class="code" href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a>** vect_data = nb_blocks_vect_.data();</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>    <span class="keywordflow">for</span> (<a class="code" href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">size_type</a> i = 0; i &lt; rsize; ++i)</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>        vect_data[i] = 0;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>    nb_gc_vect_.resize(rsize);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>    nb_bc_vect_.resize(rsize);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>    nb_xdescr_vect_.resize(rsize);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>}</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span> </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span><span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>} <span class="comment">// namespace bm</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span> </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="abm_8h_html_ad9736d9521d713fa5d48859aa720bfdd"><div class="ttname"><a href="bm_8h.html#ad9736d9521d713fa5d48859aa720bfdd">BM_DECLARE_TEMP_BLOCK</a></div><div class="ttdeci">#define BM_DECLARE_TEMP_BLOCK(x)</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00047">bm.h:47</a></div></div>
<div class="ttc" id="abmavx2_8h_html_a4a2b40d7ba2f2cae74d22c4a9680c675"><div class="ttname"><a href="bmavx2_8h.html#a4a2b40d7ba2f2cae74d22c4a9680c675">VECT_BIT_BLOCK_XOR</a></div><div class="ttdeci">#define VECT_BIT_BLOCK_XOR(t, src, src_xor, d)</div><div class="ttdef"><b>Definition:</b> <a href="bmavx2_8h_source.html#l03332">bmavx2.h:3332</a></div></div>
<div class="ttc" id="abmavx2_8h_html_abadfad850d54694fd0fa1fccc630628e"><div class="ttname"><a href="bmavx2_8h.html#abadfad850d54694fd0fa1fccc630628e">VECT_BLOCK_CHANGE</a></div><div class="ttdeci">#define VECT_BLOCK_CHANGE(block, size)</div><div class="ttdef"><b>Definition:</b> <a href="bmavx2_8h_source.html#l03314">bmavx2.h:3314</a></div></div>
<div class="ttc" id="abmavx2_8h_html_af137f165b3b57f7c30b5a5da5f1a273f"><div class="ttname"><a href="bmavx2_8h.html#af137f165b3b57f7c30b5a5da5f1a273f">VECT_BIT_BLOCK_XOR_2WAY</a></div><div class="ttdeci">#define VECT_BIT_BLOCK_XOR_2WAY(t, src_xor, d)</div><div class="ttdef"><b>Definition:</b> <a href="bmavx2_8h_source.html#l03335">bmavx2.h:3335</a></div></div>
<div class="ttc" id="abmavx2_8h_html_affdafd867133ecb554f3a79d61929dff"><div class="ttname"><a href="bmavx2_8h.html#affdafd867133ecb554f3a79d61929dff">VECT_BLOCK_XOR_CHANGE</a></div><div class="ttdeci">#define VECT_BLOCK_XOR_CHANGE(block, xor_block, size, gc, bc)</div><div class="ttdef"><b>Definition:</b> <a href="bmavx2_8h_source.html#l03317">bmavx2.h:3317</a></div></div>
<div class="ttc" id="abmdef_8h_html"><div class="ttname"><a href="bmdef_8h.html">bmdef.h</a></div><div class="ttdoc">Definitions(internal)</div></div>
<div class="ttc" id="abmdef_8h_html_a13ba598909515339ceede09e3b9b0198"><div class="ttname"><a href="bmdef_8h.html#a13ba598909515339ceede09e3b9b0198">IS_VALID_ADDR</a></div><div class="ttdeci">#define IS_VALID_ADDR(addr)</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00161">bmdef.h:161</a></div></div>
<div class="ttc" id="abmdef_8h_html_a3d4b22f50e6783522689451783907dc7"><div class="ttname"><a href="bmdef_8h.html#a3d4b22f50e6783522689451783907dc7">BMRESTRICT</a></div><div class="ttdeci">#define BMRESTRICT</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00203">bmdef.h:203</a></div></div>
<div class="ttc" id="abmdef_8h_html_a40d7d3c011d2128b1f0c392127d7d61e"><div class="ttname"><a href="bmdef_8h.html#a40d7d3c011d2128b1f0c392127d7d61e">BMNOEXCEPT</a></div><div class="ttdeci">#define BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00082">bmdef.h:82</a></div></div>
<div class="ttc" id="abmdef_8h_html_a6a7c8b8ee3f3b60ab907c1699acb7aa0"><div class="ttname"><a href="bmdef_8h.html#a6a7c8b8ee3f3b60ab907c1699acb7aa0">BMGAP_PTR</a></div><div class="ttdeci">#define BMGAP_PTR(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00189">bmdef.h:189</a></div></div>
<div class="ttc" id="abmdef_8h_html_a7bc243edc0a5e82979d6bf63f4debb9a"><div class="ttname"><a href="bmdef_8h.html#a7bc243edc0a5e82979d6bf63f4debb9a">BM_IS_GAP</a></div><div class="ttdeci">#define BM_IS_GAP(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00191">bmdef.h:191</a></div></div>
<div class="ttc" id="abmdef_8h_html_aa44515fab0ace8928d1cb82009a95bf8"><div class="ttname"><a href="bmdef_8h.html#aa44515fab0ace8928d1cb82009a95bf8">BM_ASSERT</a></div><div class="ttdeci">#define BM_ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="bmdef_8h_source.html#l00139">bmdef.h:139</a></div></div>
<div class="ttc" id="abmutil_8h_html"><div class="ttname"><a href="bmutil_8h.html">bmutil.h</a></div><div class="ttdoc">Bit manipulation primitives (internal)</div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html">bm::bv_ref_vector</a></div><div class="ttdoc">List of reference bit-vectors with their true index associations.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00623">bmxor.h:624</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a070902dc94f8ec5849bbbc56042e57bf"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a070902dc94f8ec5849bbbc56042e57bf">bm::bv_ref_vector::size_type</a></div><div class="ttdeci">bvector_type::size_type size_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00627">bmxor.h:627</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a1890388a25e54397630678d9f272d17a"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a1890388a25e54397630678d9f272d17a">bm::bv_ref_vector::bvector_type</a></div><div class="ttdeci">BV bvector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00626">bmxor.h:626</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a30788ff14aaeded05308f63da184e653"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a30788ff14aaeded05308f63da184e653">bm::bv_ref_vector::add_vectors</a></div><div class="ttdeci">void add_vectors(const BMATR &amp;bmatr)</div><div class="ttdoc">Append basic bit-matrix to the list of reference vectors.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00726">bmxor.h:726</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a3969b4db5654ba15c67a6f7df32edbdd"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a3969b4db5654ba15c67a6f7df32edbdd">bm::bv_ref_vector::block_match_chain_type</a></div><div class="ttdeci">bm::block_match_chain&lt; size_type &gt; block_match_chain_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00633">bmxor.h:633</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a42a9b5c13231d2032ba2189a96153c01"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a42a9b5c13231d2032ba2189a96153c01">bm::bv_ref_vector::fill_alloc_digest</a></div><div class="ttdeci">void fill_alloc_digest(bvector_type &amp;bv_blocks) const</div><div class="ttdoc">Fill block allocation digest for all vectors in the reference collection.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00699">bmxor.h:699</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a456f5791cc81ee1b089200f3b0b14181"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a456f5791cc81ee1b089200f3b0b14181">bm::bv_ref_vector::bv_plane_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; std::size_t, bv_allocator_type, true &gt; bv_plane_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00772">bmxor.h:772</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a4b3a5d3b1f4a9a3bf783af9dd57dbb66"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a4b3a5d3b1f4a9a3bf783af9dd57dbb66">bm::bv_ref_vector::size</a></div><div class="ttdeci">size_type size() const BMNOEXCEPT</div><div class="ttdoc">Get reference list size.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00660">bmxor.h:660</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a5da7772d7bc4a8bfa6bafd479f1c2550"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a5da7772d7bc4a8bfa6bafd479f1c2550">bm::bv_ref_vector::not_found</a></div><div class="ttdeci">static size_type not_found() BMNOEXCEPT</div><div class="ttdoc">not-found value for find methods</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00672">bmxor.h:672</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a68c28b8f86c4e0cf8afe26cab1140892"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a68c28b8f86c4e0cf8afe26cab1140892">bm::bv_ref_vector::bvector_type_ptr</a></div><div class="ttdeci">bvector_type * bvector_type_ptr</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00628">bmxor.h:628</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a6e52a29dee546e737e320a0daee784b9"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a6e52a29dee546e737e320a0daee784b9">bm::bv_ref_vector::build_nb_digest_and_xor_matrix</a></div><div class="ttdeci">bool build_nb_digest_and_xor_matrix(matrix_chain_type &amp;matr, bvector_type &amp;bv_blocks) const</div><div class="ttdoc">Calculate blocks digest and resize XOR distance matrix based on total number of available blocks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00759">bmxor.h:759</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a7da407ddf3f5ac59b1702ae236d85ce8"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a7da407ddf3f5ac59b1702ae236d85ce8">bm::bv_ref_vector::bvector_type_const_ptr</a></div><div class="ttdeci">const bvector_type * bvector_type_const_ptr</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00629">bmxor.h:629</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a7fb37bd870f784e018a684dd82b78165"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a7fb37bd870f784e018a684dd82b78165">bm::bv_ref_vector::add</a></div><div class="ttdeci">void add(const bvector_type *bv, size_type ref_idx)</div><div class="ttdoc">Add reference vector.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00652">bmxor.h:652</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a8a243086235da1b0d79143e293468463"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a8a243086235da1b0d79143e293468463">bm::bv_ref_vector::get_bv</a></div><div class="ttdeci">const bvector_type * get_bv(size_type idx) const BMNOEXCEPT</div><div class="ttdoc">Get reference vector by the index in this ref-vector.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00663">bmxor.h:663</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a955266146f2c6d48b3ff5ee329a35e23"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a955266146f2c6d48b3ff5ee329a35e23">bm::bv_ref_vector::find_bv</a></div><div class="ttdeci">size_type find_bv(const bvector_type *bv) const BMNOEXCEPT</div><div class="ttdoc">Find vector index by the pointer.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00687">bmxor.h:687</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a99679bf7956b39ee02507370751006a8"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a99679bf7956b39ee02507370751006a8">bm::bv_ref_vector::get_row_idx</a></div><div class="ttdeci">size_type get_row_idx(size_type idx) const BMNOEXCEPT</div><div class="ttdoc">Get reference row index by the index in this ref-vector.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00667">bmxor.h:667</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_a99b7a8a3de7a6f72ca28499c5bec59a6"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#a99b7a8a3de7a6f72ca28499c5bec59a6">bm::bv_ref_vector::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">reset the collection (resize(0))</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00641">bmxor.h:641</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_aa3a6cd0392fbfd9c6125f22f0ef55b7c"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#aa3a6cd0392fbfd9c6125f22f0ef55b7c">bm::bv_ref_vector::build</a></div><div class="ttdeci">void build(const BMATR &amp;bmatr)</div><div class="ttdoc">Reset and build vector of references from a basic bit-matrix all NULL rows are skipped,...</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00716">bmxor.h:716</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_ab25ec634fe2b51afeec7abb9bc9f2efd"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#ab25ec634fe2b51afeec7abb9bc9f2efd">bm::bv_ref_vector::matrix_chain_type</a></div><div class="ttdeci">bm::dynamic_heap_matrix&lt; block_match_chain_type, bv_allocator_type &gt; matrix_chain_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00636">bmxor.h:636</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_acffc08ae19830be62e6a0ccff1d760f9"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#acffc08ae19830be62e6a0ccff1d760f9">bm::bv_ref_vector::find</a></div><div class="ttdeci">size_type find(std::size_t ref_idx) const BMNOEXCEPT</div><div class="ttdoc">Find vector index by the reference index.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00676">bmxor.h:676</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_ad745dbd3f51f287af2f1e390347f4ec1"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#ad745dbd3f51f287af2f1e390347f4ec1">bm::bv_ref_vector::bvptr_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; bvector_type_const_ptr, bv_allocator_type, true &gt; bvptr_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00771">bmxor.h:771</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_adb18ffdc8b1caea62b63340366130e29"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#adb18ffdc8b1caea62b63340366130e29">bm::bv_ref_vector::resize_xor_matrix</a></div><div class="ttdeci">void resize_xor_matrix(matrix_chain_type &amp;matr, size_type total_blocks) const</div><div class="ttdoc">Utility function to resize matrix based on number of vectors and blocks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00746">bmxor.h:746</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_ae6dbbc3eddbb53aa254838221aa58151"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#ae6dbbc3eddbb53aa254838221aa58151">bm::bv_ref_vector::bv_allocator_type</a></div><div class="ttdeci">bvector_type::allocator_type bv_allocator_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00630">bmxor.h:630</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_ae7fbf468f1e47b998f5403c8e5fc2043"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#ae7fbf468f1e47b998f5403c8e5fc2043">bm::bv_ref_vector::add_sparse_vector</a></div><div class="ttdeci">void add_sparse_vector(const SV &amp;sv)</div><div class="ttdoc">Add bit-transposed sparse vector as a bit-matrix.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00739">bmxor.h:739</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_af5e4e254cee10a85934399ac65ddf8cf"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#af5e4e254cee10a85934399ac65ddf8cf">bm::bv_ref_vector::ref_bvects_rows_</a></div><div class="ttdeci">bv_plane_vector_type ref_bvects_rows_</div><div class="ttdoc">reference vector row idxs</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00777">bmxor.h:777</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_afa3ca3c464318e29fb4e24c1b7cc9574"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#afa3ca3c464318e29fb4e24c1b7cc9574">bm::bv_ref_vector::rows_acc_</a></div><div class="ttdeci">unsigned rows_acc_</div><div class="ttdoc">total rows accumulator</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00775">bmxor.h:775</a></div></div>
<div class="ttc" id="aclassbm_1_1bv__ref__vector_html_afdce5ba10c9e8167ab5974b61d36a1f9"><div class="ttname"><a href="classbm_1_1bv__ref__vector.html#afdce5ba10c9e8167ab5974b61d36a1f9">bm::bv_ref_vector::ref_bvects_</a></div><div class="ttdeci">bvptr_vector_type ref_bvects_</div><div class="ttdoc">reference vector pointers</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00776">bmxor.h:776</a></div></div>
<div class="ttc" id="aclassbm_1_1bvector_1_1enumerator_html"><div class="ttname"><a href="classbm_1_1bvector_1_1enumerator.html">bm::bvector::enumerator</a></div><div class="ttdoc">Constant iterator designed to enumerate &quot;ON&quot; bits.</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00602">bm.h:603</a></div></div>
<div class="ttc" id="aclassbm_1_1bvector_1_1iterator__base_html_a3f6af7f5b46c0219b28916187d302c43"><div class="ttname"><a href="classbm_1_1bvector_1_1iterator__base.html#a3f6af7f5b46c0219b28916187d302c43">bm::bvector::iterator_base::valid</a></div><div class="ttdeci">bool valid() const BMNOEXCEPT</div><div class="ttdoc">Checks if iterator is still valid.</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00283">bm.h:283</a></div></div>
<div class="ttc" id="aclassbm_1_1bvector_html_a7fea809653a2792c84fd10c92b5c47c4"><div class="ttname"><a href="classbm_1_1bvector.html#a7fea809653a2792c84fd10c92b5c47c4">bm::bvector::size_type</a></div><div class="ttdeci">bvector_size_type size_type</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00121">bm.h:121</a></div></div>
<div class="ttc" id="aclassbm_1_1bvector_html_ad1dbe63690fd5cd2b1e064795d3f1b6c"><div class="ttname"><a href="classbm_1_1bvector.html#ad1dbe63690fd5cd2b1e064795d3f1b6c">bm::bvector::allocator_type</a></div><div class="ttdeci">Alloc allocator_type</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00117">bm.h:117</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html"><div class="ttname"><a href="classbm_1_1xor__scanner.html">bm::xor_scanner</a></div><div class="ttdoc">XOR scanner to search for complement-similarities in collections of bit-vectors.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00819">bmxor.h:820</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a0216b9d4c0e68d30092b703966d2ecb9"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a0216b9d4c0e68d30092b703966d2ecb9">bm::xor_scanner::get_s_gc</a></div><div class="ttdeci">unsigned get_s_gc() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00955">bmxor.h:955</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a03e501ce3b601a6eeb6ab0f4245b5c88"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a03e501ce3b601a6eeb6ab0f4245b5c88">bm::xor_scanner::get_ref_block</a></div><div class="ttdeci">const bm::word_t * get_ref_block(size_type ri, unsigned i, unsigned j) const BMNOEXCEPT</div><div class="ttdoc">Return block from the reference vector [vect_idx, block_i, block_j].</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00974">bmxor.h:974</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a08f077ce0be6c531162012a8c840360b"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a08f077ce0be6c531162012a8c840360b">bm::xor_scanner::best_metric</a></div><div class="ttdeci">static bm::xor_complement_match best_metric(unsigned bc, unsigned gc, unsigned *best_metric) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01641">bmxor.h:1641</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a090167083a2ac17faaa98bbb35b7576c"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a090167083a2ac17faaa98bbb35b7576c">bm::xor_scanner::bv_ref_vector_type</a></div><div class="ttdeci">bm::bv_ref_vector&lt; BV &gt; bv_ref_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00822">bmxor.h:822</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a0c178a345699fd2eaed95fd7e2325de5"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a0c178a345699fd2eaed95fd7e2325de5">bm::xor_scanner::bv_bcgc_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; unsigned, bv_allocator_type, true &gt; bv_bcgc_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00836">bmxor.h:836</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a14248c41706e978896cfe97bdc99c80a"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a14248c41706e978896cfe97bdc99c80a">bm::xor_scanner::sync_nb_vect</a></div><div class="ttdeci">void sync_nb_vect()</div><div class="ttdoc">Sync TEMP vector size.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01732">bmxor.h:1732</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a14a82d152a45202797abe5ac03db5c4b"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a14a82d152a45202797abe5ac03db5c4b">bm::xor_scanner::size_type</a></div><div class="ttdeci">bvector_type::size_type size_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00825">bmxor.h:825</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a1ae26d727b369930dcf92a70b4f30e95"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a1ae26d727b369930dcf92a70b4f30e95">bm::xor_scanner::search_best_xor_mask</a></div><div class="ttdeci">bm::xor_complement_match search_best_xor_mask(const bm::word_t *s_block, size_type ri, size_type ridx_from, size_type ridx_to, unsigned i, unsigned j, bm::word_t *tx_block, const bm::xor_sim_params &amp;params)</div><div class="ttdoc">Scan for all candidate bit-blocks to find mask or match.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01246">bmxor.h:1246</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a1c235a922f3004ee5358e963b4b76d96"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a1c235a922f3004ee5358e963b4b76d96">bm::xor_scanner::free_blocks</a></div><div class="ttdeci">void free_blocks() BMNOEXCEPT</div><div class="ttdoc">Free the collection of temp blocks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01675">bmxor.h:1675</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a1ca43839153238d641db3888c728d4f7"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a1ca43839153238d641db3888c728d4f7">bm::xor_scanner::get_x_best_metric</a></div><div class="ttdeci">unsigned get_x_best_metric() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00951">bmxor.h:951</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a2158dbdf98829c65cc6a887ee0632a33"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a2158dbdf98829c65cc6a887ee0632a33">bm::xor_scanner::validate_xor</a></div><div class="ttdeci">bool validate_xor(const bm::word_t *xor_block) const BMNOEXCEPT</div><div class="ttdoc">Check if XOR transform simplified block enough for compressibility objective.</div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a248f89db300ac5c9c39d3cd6fbd6946d"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a248f89db300ac5c9c39d3cd6fbd6946d">bm::xor_scanner::compute_sim_model</a></div><div class="ttdeci">bool compute_sim_model(xor_sim_model&lt; BV &gt; &amp;sim_model, const bv_ref_vector_type &amp;ref_vect, const bm::xor_sim_params &amp;params)</div><div class="ttdoc">Calculate matrix of best XOR match metrics per block for the attached collection of bit-vectors.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01440">bmxor.h:1440</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a2c60e5f0741c2f5571e3b8ec05289912"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a2c60e5f0741c2f5571e3b8ec05289912">bm::xor_scanner::get_s_block_stats</a></div><div class="ttdeci">void get_s_block_stats(size_type ri) BMNOEXCEPT</div><div class="ttdoc">Get statistics for the r-(or s-) block.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01045">bmxor.h:1045</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a2f568a5891ed262156ec7283b6d5528a"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a2f568a5891ed262156ec7283b6d5528a">bm::xor_scanner::get_match_vector</a></div><div class="ttdeci">xor_matches_vector_type &amp; get_match_vector() BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00966">bmxor.h:966</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a55958d5cba850206b8ecb5b55d9c671d"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a55958d5cba850206b8ecb5b55d9c671d">bm::xor_scanner::get_match_pairs</a></div><div class="ttdeci">match_pairs_vector_type &amp; get_match_pairs() BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00969">bmxor.h:969</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a5e47d6b287b0cc1d02deb3f99dfcfa0e"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a5e47d6b287b0cc1d02deb3f99dfcfa0e">bm::xor_scanner::refine_match_chain</a></div><div class="ttdeci">size_type refine_match_chain()</div><div class="ttdoc">Run a search to add possible XOR match chain additions.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01425">bmxor.h:1425</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a60143e88fb9decae4a94952083370e1a"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a60143e88fb9decae4a94952083370e1a">bm::xor_scanner::get_xor_digest</a></div><div class="ttdeci">bm::id64_t get_xor_digest() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00952">bmxor.h:952</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a674e2bed6302843d1351fe42a7c01e89"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a674e2bed6302843d1351fe42a7c01e89">bm::xor_scanner::bv_allocator_type</a></div><div class="ttdeci">bvector_type::allocator_type bv_allocator_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00824">bmxor.h:824</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a7a7d1141fbcd94f8e1df0376a0a34955"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a7a7d1141fbcd94f8e1df0376a0a34955">bm::xor_scanner::get_s_bc</a></div><div class="ttdeci">unsigned get_s_bc() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00954">bmxor.h:954</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a7e16e0565419864210134fd297089aef"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a7e16e0565419864210134fd297089aef">bm::xor_scanner::matrix_chain_type</a></div><div class="ttdeci">bv_ref_vector_type::matrix_chain_type matrix_chain_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00832">bmxor.h:832</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a82016728a3071d7f0e06c1355a8a356f"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a82016728a3071d7f0e06c1355a8a356f">bm::xor_scanner::deoptimize_gap_blocks</a></div><div class="ttdeci">void deoptimize_gap_blocks(size_type nb, const xor_sim_params &amp;params)</div><div class="ttdoc">Deoptimize vertical slice of GAP blocks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01690">bmxor.h:1690</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a8245351dd91f3ad3795ae7823872bf0c"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a8245351dd91f3ad3795ae7823872bf0c">bm::xor_scanner::get_s_block_best</a></div><div class="ttdeci">unsigned get_s_block_best() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00956">bmxor.h:956</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a84d854e3af0d858917ee9ec449fc837f"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a84d854e3af0d858917ee9ec449fc837f">bm::xor_scanner::~xor_scanner</a></div><div class="ttdeci">~xor_scanner()</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00844">bmxor.h:844</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a8799f4a72e999334c5de82d99437d3c2"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a8799f4a72e999334c5de82d99437d3c2">bm::xor_scanner::xor_matches_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; bm::block_xor_match_descr, bv_allocator_type, true &gt; xor_matches_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00828">bmxor.h:828</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a897b8cfd4f2da327e10ff5f6b6864f81"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a897b8cfd4f2da327e10ff5f6b6864f81">bm::xor_scanner::get_descr</a></div><div class="ttdeci">bm::block_waves_xor_descr &amp; get_descr() BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00960">bmxor.h:960</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_a8c81222aa192ce1f0a4fce162c98dee8"><div class="ttname"><a href="classbm_1_1xor__scanner.html#a8c81222aa192ce1f0a4fce162c98dee8">bm::xor_scanner::compute_s_block_stats</a></div><div class="ttdeci">void compute_s_block_stats(const bm::word_t *block) BMNOEXCEPT</div><div class="ttdoc">Compute statistics for the r-(or s-) block.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01057">bmxor.h:1057</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_aa86e57ed4a80216bb4a4f51042c49415"><div class="ttname"><a href="classbm_1_1xor__scanner.html#aa86e57ed4a80216bb4a4f51042c49415">bm::xor_scanner::get_best_match_type</a></div><div class="ttdeci">bm::xor_complement_match get_best_match_type() const BMNOEXCEPT</div><div class="ttdoc">Return best match type of a found block.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00946">bmxor.h:946</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_aaaf5d137f66ee3d80bb9d3354879e6ca"><div class="ttname"><a href="classbm_1_1xor__scanner.html#aaaf5d137f66ee3d80bb9d3354879e6ca">bm::xor_scanner::bv_xdescr_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; bm::block_waves_xor_descr, bv_allocator_type, true &gt; bv_xdescr_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00839">bmxor.h:839</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_aadb5803354a0d483aec46eb65edc5e28"><div class="ttname"><a href="classbm_1_1xor__scanner.html#aadb5803354a0d483aec46eb65edc5e28">bm::xor_scanner::get_ref_vector</a></div><div class="ttdeci">const bv_ref_vector_type &amp; get_ref_vector() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00853">bmxor.h:853</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_ac76bf3e9d94d83388f940bbd0ff24890"><div class="ttname"><a href="classbm_1_1xor__scanner.html#ac76bf3e9d94d83388f940bbd0ff24890">bm::xor_scanner::bvector_type</a></div><div class="ttdeci">BV bvector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00823">bmxor.h:823</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_acd129f61af747435fb452c0250148fde"><div class="ttname"><a href="classbm_1_1xor__scanner.html#acd129f61af747435fb452c0250148fde">bm::xor_scanner::found_ridx</a></div><div class="ttdeci">size_type found_ridx() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00942">bmxor.h:942</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_ae45de6535b600285791f595e8fa13b59"><div class="ttname"><a href="classbm_1_1xor__scanner.html#ae45de6535b600285791f595e8fa13b59">bm::xor_scanner::apply_xor_match_vector</a></div><div class="ttdeci">void apply_xor_match_vector(bm::word_t *target_xor_block, const bm::word_t *s_block, size_type s_ri, const match_pairs_vector_type &amp;pm_vect, unsigned i, unsigned j) const BMNOEXCEPT</div><div class="ttdoc">XOR all match blocks to target using their digest masks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01607">bmxor.h:1607</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_ae6ce31b2065b0b68ba366335fca399f4"><div class="ttname"><a href="classbm_1_1xor__scanner.html#ae6ce31b2065b0b68ba366335fca399f4">bm::xor_scanner::xor_scanner</a></div><div class="ttdeci">xor_scanner()</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00843">bmxor.h:843</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_ae8b7b41cdcfe827ee6b89ff8781f09c4"><div class="ttname"><a href="classbm_1_1xor__scanner.html#ae8b7b41cdcfe827ee6b89ff8781f09c4">bm::xor_scanner::compute_xor_complexity_descr</a></div><div class="ttdeci">void compute_xor_complexity_descr(const bm::word_t *BMRESTRICT block, bm::id64_t block_d64, const bm::word_t *BMRESTRICT xor_block, bm::block_waves_xor_descr &amp;BMRESTRICT x_descr, bm::block_xor_match_descr &amp;BMRESTRICT xmd) const BMNOEXCEPT</div><div class="ttdoc">Compute reference complexity descriptor based on XOR vector.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l01070">bmxor.h:1070</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_ae901352e9450d01beac93a20a48cb7d5"><div class="ttname"><a href="classbm_1_1xor__scanner.html#ae901352e9450d01beac93a20a48cb7d5">bm::xor_scanner::set_ref_vector</a></div><div class="ttdeci">void set_ref_vector(const bv_ref_vector_type *ref_vect) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00850">bmxor.h:850</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_af1ca6bb7d544b193d32b9541742ad075"><div class="ttname"><a href="classbm_1_1xor__scanner.html#af1ca6bb7d544b193d32b9541742ad075">bm::xor_scanner::get_found_block</a></div><div class="ttdeci">const bm::word_t * get_found_block() const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00949">bmxor.h:949</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_af322937c6268e97fada78ce7028ada69"><div class="ttname"><a href="classbm_1_1xor__scanner.html#af322937c6268e97fada78ce7028ada69">bm::xor_scanner::match_pairs_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; bm::match_pair, bv_allocator_type, true &gt; match_pairs_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00830">bmxor.h:830</a></div></div>
<div class="ttc" id="aclassbm_1_1xor__scanner_html_af930cb73151f6a1fa248bd46a3b6940a"><div class="ttname"><a href="classbm_1_1xor__scanner.html#af930cb73151f6a1fa248bd46a3b6940a">bm::xor_scanner::bv_blocks_vector_type</a></div><div class="ttdeci">bm::heap_vector&lt; bm::word_t *, bv_allocator_type, true &gt; bv_blocks_vector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00834">bmxor.h:834</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga0cac3b111c2a2f9cc1995d2c3e94f361"><div class="ttname"><a href="group__bitfunc.html#ga0cac3b111c2a2f9cc1995d2c3e94f361">bm::word_bitcount</a></div><div class="ttdeci">BMFORCEINLINE bm::id_t word_bitcount(bm::id_t w) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmutil_8h_source.html#l00575">bmutil.h:575</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga0cbf0c0227b7624f95bd9cff87e2e032"><div class="ttname"><a href="group__bitfunc.html#ga0cbf0c0227b7624f95bd9cff87e2e032">bm::bit_block_xor_change64</a></div><div class="ttdeci">void bit_block_xor_change64(const bm::word_t *BMRESTRICT s_block, const bm::word_t *BMRESTRICT ref_block, unsigned size, unsigned *BMRESTRICT gc, unsigned *BMRESTRICT bc) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00151">bmxor.h:151</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga0f3ced2486b1b44958aaa446c3f45174"><div class="ttname"><a href="group__bitfunc.html#ga0f3ced2486b1b44958aaa446c3f45174">bm::bit_count_min_unroll</a></div><div class="ttdeci">BMFORCEINLINE unsigned bit_count_min_unroll(const bm::word_t *BMRESTRICT block, const bm::word_t *BMRESTRICT block_end) BMNOEXCEPT</div><div class="ttdoc">Bitcount for bit block without agressive unrolling.</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l04953">bmfunc.h:4953</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga3a7dc6e5554518cbf2c5f54129833a52"><div class="ttname"><a href="group__bitfunc.html#ga3a7dc6e5554518cbf2c5f54129833a52">bm::bit_block_xor_change32</a></div><div class="ttdeci">void bit_block_xor_change32(const bm::word_t *BMRESTRICT block, const bm::word_t *BMRESTRICT xor_block, unsigned size, unsigned *BMRESTRICT gc, unsigned *BMRESTRICT bc) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00096">bmxor.h:96</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga687da4e4a99caf94853bceab69f17210"><div class="ttname"><a href="group__bitfunc.html#ga687da4e4a99caf94853bceab69f17210">bm::word_bitcount64</a></div><div class="ttdeci">BMFORCEINLINE unsigned word_bitcount64(bm::id64_t x) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmutil_8h_source.html#l00598">bmutil.h:598</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_ga903047d3a2578c8b512c6fc5896fa62d"><div class="ttname"><a href="group__bitfunc.html#ga903047d3a2578c8b512c6fc5896fa62d">bm::calc_block_digest0</a></div><div class="ttdeci">bm::id64_t calc_block_digest0(const bm::word_t *const block) BMNOEXCEPT</div><div class="ttdoc">Compute digest for 64 non-zero areas.</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l01083">bmfunc.h:1083</a></div></div>
<div class="ttc" id="agroup__bitfunc_html_gaad6d82e594a74711de7cbd4fd7cfb1a7"><div class="ttname"><a href="group__bitfunc.html#gaad6d82e594a74711de7cbd4fd7cfb1a7">bm::bit_block_xor</a></div><div class="ttdeci">bm::id64_t bit_block_xor(bm::word_t *BMRESTRICT dst, const bm::word_t *BMRESTRICT src) BMNOEXCEPT</div><div class="ttdoc">Plain bitblock XOR operation. Function does not analyse availability of source and destination blocks...</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l08157">bmfunc.h:8157</a></div></div>
<div class="ttc" id="agroup__gapfunc_html_ga46b1ef5db20451ece81c0a8324e035e3"><div class="ttname"><a href="group__gapfunc.html#ga46b1ef5db20451ece81c0a8324e035e3">bm::gap_convert_to_bitset</a></div><div class="ttdeci">void gap_convert_to_bitset(unsigned *BMRESTRICT dest, const T *BMRESTRICT buf, unsigned len=0) BMNOEXCEPT</div><div class="ttdoc">GAP block to bitblock conversion.</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l04432">bmfunc.h:4432</a></div></div>
<div class="ttc" id="agroup__gapfunc_html_gae851a912a38bc6ef20e051a9e6ee099a"><div class="ttname"><a href="group__gapfunc.html#gae851a912a38bc6ef20e051a9e6ee099a">bm::gap_length</a></div><div class="ttdeci">BMFORCEINLINE bm::gap_word_t gap_length(const bm::gap_word_t *BMRESTRICT buf) BMNOEXCEPT</div><div class="ttdoc">Returs GAP block length.</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l01566">bmfunc.h:1566</a></div></div>
<div class="ttc" id="anamespacebm_html"><div class="ttname"><a href="namespacebm.html">bm</a></div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00077">bm.h:78</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5e"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5e">bm::xor_complement_match</a></div><div class="ttdeci">xor_complement_match</div><div class="ttdoc">XOR complementarity type between 2 blocks.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00080">bmxor.h:81</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea0910de9a59fcfde72786bf3b2e5525be">bm::e_no_xor_match</a></div><div class="ttdeci">@ e_no_xor_match</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00082">bmxor.h:82</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea728ed6d49954f6ac70532b44245d98f0">bm::e_xor_match_GC</a></div><div class="ttdeci">@ e_xor_match_GC</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00083">bmxor.h:83</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5ea7b37994f74ba7719a96c44c8d76efd73">bm::e_xor_match_BC</a></div><div class="ttdeci">@ e_xor_match_BC</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00084">bmxor.h:84</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eaa26451d755f594ccc5efcd0995171512">bm::e_xor_match_EQ</a></div><div class="ttdeci">@ e_xor_match_EQ</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00087">bmxor.h:86</a></div></div>
<div class="ttc" id="anamespacebm_html_a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b"><div class="ttname"><a href="namespacebm.html#a0144c0a7555264da06df595b09a76e5eabe195aeb1f6d0a3b0f0017e4441a076b">bm::e_xor_match_iBC</a></div><div class="ttdeci">@ e_xor_match_iBC</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00085">bmxor.h:85</a></div></div>
<div class="ttc" id="anamespacebm_html_a0967e424b39ee2667c4d2ae80102c33e"><div class="ttname"><a href="namespacebm.html#a0967e424b39ee2667c4d2ae80102c33e">bm::set_block_digest_wave_size</a></div><div class="ttdeci">const unsigned set_block_digest_wave_size</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00067">bmconst.h:67</a></div></div>
<div class="ttc" id="anamespacebm_html_a0a024b52eb991e70a9fa9936f9b1ba40"><div class="ttname"><a href="namespacebm.html#a0a024b52eb991e70a9fa9936f9b1ba40">bm::bit_block_change_bc</a></div><div class="ttdeci">void bit_block_change_bc(const bm::word_t *BMRESTRICT block, unsigned *BMRESTRICT gc, unsigned *BMRESTRICT bc) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l05209">bmfunc.h:5209</a></div></div>
<div class="ttc" id="anamespacebm_html_a17fd5ba52db3ddda05e6f8dd5000a1a4"><div class="ttname"><a href="namespacebm.html#a17fd5ba52db3ddda05e6f8dd5000a1a4">bm::word_t</a></div><div class="ttdeci">unsigned int word_t</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00039">bmconst.h:39</a></div></div>
<div class="ttc" id="anamespacebm_html_a1ca7473948f0c934f771454f5b1c4e28"><div class="ttname"><a href="namespacebm.html#a1ca7473948f0c934f771454f5b1c4e28">bm::check_pair_vect_vbr</a></div><div class="ttdeci">unsigned char check_pair_vect_vbr(const BMChain &amp;mchain, const RVect &amp;ref_vect)</div><div class="ttdoc">Check effective bit-rate for the XOR encode vector.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00404">bmxor.h:404</a></div></div>
<div class="ttc" id="anamespacebm_html_a34977fdaa1b6fc8dc9951bc7eba98ea6"><div class="ttname"><a href="namespacebm.html#a34977fdaa1b6fc8dc9951bc7eba98ea6">bm::compute_s_block_descr</a></div><div class="ttdeci">void compute_s_block_descr(const bm::word_t *BMRESTRICT block, block_waves_xor_descr &amp;BMRESTRICT x_descr, unsigned *BMRESTRICT s_gc, unsigned *BMRESTRICT s_bc) BMNOEXCEPT</div><div class="ttdoc">Compute reference (non-XOR) 64-dim complexity descriptor for the s-block.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00430">bmxor.h:430</a></div></div>
<div class="ttc" id="anamespacebm_html_a396465b416ef1bc9d72afad6d088b759"><div class="ttname"><a href="namespacebm.html#a396465b416ef1bc9d72afad6d088b759">bm::bit_block_change64</a></div><div class="ttdeci">unsigned bit_block_change64(const bm::word_t *BMRESTRICT in_block, unsigned size) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l05160">bmfunc.h:5160</a></div></div>
<div class="ttc" id="anamespacebm_html_a433a2db7a9c62fa1a31b85d80c311391"><div class="ttname"><a href="namespacebm.html#a433a2db7a9c62fa1a31b85d80c311391">bm::get_block_coord</a></div><div class="ttdeci">BMFORCEINLINE void get_block_coord(BI_TYPE nb, unsigned &amp;i, unsigned &amp;j) BMNOEXCEPT</div><div class="ttdoc">Recalc linear bvector block index into 2D matrix coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l00163">bmfunc.h:163</a></div></div>
<div class="ttc" id="anamespacebm_html_a46a7c02fff53ca169e6482d4942f96f7"><div class="ttname"><a href="namespacebm.html#a46a7c02fff53ca169e6482d4942f96f7">bm::greedy_refine_match_vector</a></div><div class="ttdeci">VT::size_type greedy_refine_match_vector(PVT &amp;match_pairs_vect, VT &amp;match_vect, typename VT::size_type best_ref_idx, bm::id64_t d64, bm::xor_complement_match match_type)</div><div class="ttdoc">Greedy algorithm to find additional matches improving the inital best match block on its match type.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00327">bmxor.h:327</a></div></div>
<div class="ttc" id="anamespacebm_html_a7158ed663405dd637ba68a475118a288"><div class="ttname"><a href="namespacebm.html#a7158ed663405dd637ba68a475118a288">bm::block_find_first_diff</a></div><div class="ttdeci">bool block_find_first_diff(const bm::word_t *BMRESTRICT blk, const bm::word_t *BMRESTRICT arg_blk, unsigned *BMRESTRICT pos) BMNOEXCEPT</div><div class="ttdoc">Find first bit which is different between two blocks (GAP or bit)</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l08944">bmfunc.h:8944</a></div></div>
<div class="ttc" id="anamespacebm_html_a933991b5bb4ce62227584037909e9195"><div class="ttname"><a href="namespacebm.html#a933991b5bb4ce62227584037909e9195">bm::id64_t</a></div><div class="ttdeci">unsigned long long int id64_t</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00035">bmconst.h:35</a></div></div>
<div class="ttc" id="anamespacebm_html_a9379d91f5ff55905dfae23982ac31f5b"><div class="ttname"><a href="namespacebm.html#a9379d91f5ff55905dfae23982ac31f5b">bm::block_waves</a></div><div class="ttdeci">const unsigned block_waves</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00066">bmconst.h:66</a></div></div>
<div class="ttc" id="anamespacebm_html_a99bf2a95e59b587281b7058ea9e7d04c"><div class="ttname"><a href="namespacebm.html#a99bf2a95e59b587281b7058ea9e7d04c">bm::bit_block_change32</a></div><div class="ttdeci">unsigned bit_block_change32(const bm::word_t *BMRESTRICT block, unsigned size) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmfunc_8h_source.html#l05118">bmfunc.h:5118</a></div></div>
<div class="ttc" id="anamespacebm_html_ab8eaf7a7124a6f55049c0cb49a08a4f8"><div class="ttname"><a href="namespacebm.html#ab8eaf7a7124a6f55049c0cb49a08a4f8">bm::bmi_bslr_u64</a></div><div class="ttdeci">BMFORCEINLINE unsigned long long bmi_bslr_u64(unsigned long long w) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmutil_8h_source.html#l00337">bmutil.h:337</a></div></div>
<div class="ttc" id="anamespacebm_html_ac654d6319039a86546d235a236fc7cf6"><div class="ttname"><a href="namespacebm.html#ac654d6319039a86546d235a236fc7cf6">bm::gap_word_t</a></div><div class="ttdeci">unsigned short gap_word_t</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00078">bmconst.h:78</a></div></div>
<div class="ttc" id="anamespacebm_html_acd2b71d7a1e902a6f5bbf87c725ecacc"><div class="ttname"><a href="namespacebm.html#acd2b71d7a1e902a6f5bbf87c725ecacc">bm::bvector_size_type</a></div><div class="ttdeci">bm::id_t bvector_size_type</div><div class="ttdef"><b>Definition:</b> <a href="bm_8h_source.html#l00103">bm.h:103</a></div></div>
<div class="ttc" id="anamespacebm_html_ad0b8714080144ac70197840ff96752b7"><div class="ttname"><a href="namespacebm.html#ad0b8714080144ac70197840ff96752b7">bm::gap_max_bits</a></div><div class="ttdeci">const unsigned gap_max_bits</div><div class="ttdef"><b>Definition:</b> <a href="bmconst_8h_source.html#l00081">bmconst.h:81</a></div></div>
<div class="ttc" id="anamespacebm_html_ae1af13fc16ae99f74d327349d49803ae"><div class="ttname"><a href="namespacebm.html#ae1af13fc16ae99f74d327349d49803ae">bm::bmi_blsi_u64</a></div><div class="ttdeci">BMFORCEINLINE unsigned long long bmi_blsi_u64(unsigned long long w)</div><div class="ttdef"><b>Definition:</b> <a href="bmutil_8h_source.html#l00347">bmutil.h:347</a></div></div>
<div class="ttc" id="anamespacebm_html_afddbb0034ce383a1fc2693196c472c81"><div class="ttname"><a href="namespacebm.html#afddbb0034ce383a1fc2693196c472c81">bm::bit_block_xor_change</a></div><div class="ttdeci">void bit_block_xor_change(const bm::word_t *BMRESTRICT block, const bm::word_t *BMRESTRICT xor_block, unsigned size, unsigned *BMRESTRICT gc, unsigned *BMRESTRICT bc) BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00207">bmxor.h:207</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html"><div class="ttname"><a href="structbm_1_1block__match__chain.html">bm::block_match_chain</a></div><div class="ttdoc">XOR match chain.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00289">bmxor.h:290</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_a409849a3a91d76d8512918531d64680c"><div class="ttname"><a href="structbm_1_1block__match__chain.html#a409849a3a91d76d8512918531d64680c">bm::block_match_chain::nb</a></div><div class="ttdeci">BLOCK_IDX nb</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00291">bmxor.h:291</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_a749651c26c4687449e8bc302ee9515a3"><div class="ttname"><a href="structbm_1_1block__match__chain.html#a749651c26c4687449e8bc302ee9515a3">bm::block_match_chain::chain_size</a></div><div class="ttdeci">unsigned chain_size</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00292">bmxor.h:292</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_a83fad2d17507bda2e7cb4a36f452f9a4"><div class="ttname"><a href="structbm_1_1block__match__chain.html#a83fad2d17507bda2e7cb4a36f452f9a4">bm::block_match_chain::operator==</a></div><div class="ttdeci">bool operator==(const block_match_chain &amp;bmc) const BMNOEXCEPT</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00297">bmxor.h:297</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_a8487bd6907a20c4bfb4c4758230694af"><div class="ttname"><a href="structbm_1_1block__match__chain.html#a8487bd6907a20c4bfb4c4758230694af">bm::block_match_chain::xor_d64</a></div><div class="ttdeci">bm::id64_t xor_d64[64]</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00294">bmxor.h:294</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_aa18e4afa795f64e33f451f14322c4b3e"><div class="ttname"><a href="structbm_1_1block__match__chain.html#aa18e4afa795f64e33f451f14322c4b3e">bm::block_match_chain::ref_idx</a></div><div class="ttdeci">unsigned ref_idx[64]</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00293">bmxor.h:293</a></div></div>
<div class="ttc" id="astructbm_1_1block__match__chain_html_ae5fb4ca907737fc6ffa09294d32d4063"><div class="ttname"><a href="structbm_1_1block__match__chain.html#ae5fb4ca907737fc6ffa09294d32d4063">bm::block_match_chain::match</a></div><div class="ttdeci">bm::xor_complement_match match</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00295">bmxor.h:295</a></div></div>
<div class="ttc" id="astructbm_1_1block__waves__xor__descr_html"><div class="ttname"><a href="structbm_1_1block__waves__xor__descr.html">bm::block_waves_xor_descr</a></div><div class="ttdoc">Structure to compute XOR gap-count profile by sub-block waves.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00229">bmxor.h:230</a></div></div>
<div class="ttc" id="astructbm_1_1block__waves__xor__descr_html_a78c4c60344fc7c0c3eb88b0ec7af1c70"><div class="ttname"><a href="structbm_1_1block__waves__xor__descr.html#a78c4c60344fc7c0c3eb88b0ec7af1c70">bm::block_waves_xor_descr::sb_bc</a></div><div class="ttdeci">unsigned short sb_bc[bm::block_waves]</div><div class="ttdoc">BIT counts.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00233">bmxor.h:233</a></div></div>
<div class="ttc" id="astructbm_1_1block__waves__xor__descr_html_a89973edd27d865c4fa4ee285d92fa03b"><div class="ttname"><a href="structbm_1_1block__waves__xor__descr.html#a89973edd27d865c4fa4ee285d92fa03b">bm::block_waves_xor_descr::sb_gc</a></div><div class="ttdeci">unsigned short sb_gc[bm::block_waves]</div><div class="ttdoc">GAP counts.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00232">bmxor.h:232</a></div></div>
<div class="ttc" id="astructbm_1_1block__waves__xor__descr_html_a953d914d8772981bbfa709bd1f8c1353"><div class="ttname"><a href="structbm_1_1block__waves__xor__descr.html#a953d914d8772981bbfa709bd1f8c1353">bm::block_waves_xor_descr::sb_xor_gc</a></div><div class="ttdeci">unsigned short sb_xor_gc[bm::block_waves]</div><div class="ttdoc">XOR-mask GAP count.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00236">bmxor.h:236</a></div></div>
<div class="ttc" id="astructbm_1_1block__waves__xor__descr_html_ae6cf7b55a41c738b35769362323432af"><div class="ttname"><a href="structbm_1_1block__waves__xor__descr.html#ae6cf7b55a41c738b35769362323432af">bm::block_waves_xor_descr::sb_xor_bc</a></div><div class="ttdeci">unsigned short sb_xor_bc[bm::block_waves]</div><div class="ttdoc">XOR-mask GAP count.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00237">bmxor.h:237</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html">bm::block_xor_match_descr</a></div><div class="ttdoc">Capture the XOR filter results (xor block against ref.block)</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00244">bmxor.h:245</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a15dd01eabe9804009215d4e4e0bb8285"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a15dd01eabe9804009215d4e4e0bb8285">bm::block_xor_match_descr::gc_gain</a></div><div class="ttdeci">unsigned gc_gain</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00259">bmxor.h:259</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a1996229e204dd83006f94dbfe66ddbf4"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a1996229e204dd83006f94dbfe66ddbf4">bm::block_xor_match_descr::ref_idx</a></div><div class="ttdeci">size_type ref_idx</div><div class="ttdoc">reference vector index</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00250">bmxor.h:250</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a32fcb9286c0c93a1d68f849b88f94a91"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a32fcb9286c0c93a1d68f849b88f94a91">bm::block_xor_match_descr::bc_gain</a></div><div class="ttdeci">unsigned bc_gain</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00260">bmxor.h:260</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a3a194d3e860da37c6e16755805574788"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a3a194d3e860da37c6e16755805574788">bm::block_xor_match_descr::xor_gc</a></div><div class="ttdeci">unsigned xor_gc</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00263">bmxor.h:263</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a4c65e8e6d0079b20d78ef17ec5ea50d8"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a4c65e8e6d0079b20d78ef17ec5ea50d8">bm::block_xor_match_descr::xor_bc</a></div><div class="ttdeci">unsigned xor_bc</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00264">bmxor.h:264</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a533ce11b3a33ad7b1b0105b29940150a"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a533ce11b3a33ad7b1b0105b29940150a">bm::block_xor_match_descr::xor_d64</a></div><div class="ttdeci">bm::id64_t xor_d64</div><div class="ttdoc">recorded digest</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00251">bmxor.h:251</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a67625671ed19599882cdc3d71908df22"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a67625671ed19599882cdc3d71908df22">bm::block_xor_match_descr::bc_d64</a></div><div class="ttdeci">bm::id64_t bc_d64</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00255">bmxor.h:255</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_a6838dd2e66ec91998d4fb105d52a21f0"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#a6838dd2e66ec91998d4fb105d52a21f0">bm::block_xor_match_descr::gc_d64</a></div><div class="ttdeci">bm::id64_t gc_d64</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00254">bmxor.h:254</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_aa251e7696aba3937edff85160886708e"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#aa251e7696aba3937edff85160886708e">bm::block_xor_match_descr::block_xor_match_descr</a></div><div class="ttdeci">block_xor_match_descr()</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00266">bmxor.h:266</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_aa2c08db6838741df09378fb872b4acec"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#aa2c08db6838741df09378fb872b4acec">bm::block_xor_match_descr::ibc_gain</a></div><div class="ttdeci">unsigned ibc_gain</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00261">bmxor.h:261</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_ad7cdb4c6d880958e453d42e142c8ef28"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#ad7cdb4c6d880958e453d42e142c8ef28">bm::block_xor_match_descr::size_type</a></div><div class="ttdeci">bvector_size_type size_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00246">bmxor.h:246</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_adb2c906a464212b88c54dbd8bee81a89"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#adb2c906a464212b88c54dbd8bee81a89">bm::block_xor_match_descr::block_gain</a></div><div class="ttdeci">unsigned block_gain</div><div class="ttdoc">XOR filter improvement (best)</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00249">bmxor.h:249</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_aee655146c2715f0df84dd9c3c3e96628"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#aee655146c2715f0df84dd9c3c3e96628">bm::block_xor_match_descr::ibc_d64</a></div><div class="ttdeci">bm::id64_t ibc_d64</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00256">bmxor.h:256</a></div></div>
<div class="ttc" id="astructbm_1_1block__xor__match__descr_html_af758505f36db3dad329c5183e3056a50"><div class="ttname"><a href="structbm_1_1block__xor__match__descr.html#af758505f36db3dad329c5183e3056a50">bm::block_xor_match_descr::match_type</a></div><div class="ttdeci">bm::xor_complement_match match_type</div><div class="ttdoc">match type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00248">bmxor.h:248</a></div></div>
<div class="ttc" id="astructbm_1_1match__pair_html"><div class="ttname"><a href="structbm_1_1match__pair.html">bm::match_pair</a></div><div class="ttdoc">XOR match pair.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00273">bmxor.h:274</a></div></div>
<div class="ttc" id="astructbm_1_1match__pair_html_a79979b730c4d90def6185faff211479d"><div class="ttname"><a href="structbm_1_1match__pair.html#a79979b730c4d90def6185faff211479d">bm::match_pair::ref_idx</a></div><div class="ttdeci">bvector_size_type ref_idx</div><div class="ttdoc">reference vector index</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00275">bmxor.h:275</a></div></div>
<div class="ttc" id="astructbm_1_1match__pair_html_a9871fcc8580a3af4f1b3a020e8c10a1a"><div class="ttname"><a href="structbm_1_1match__pair.html#a9871fcc8580a3af4f1b3a020e8c10a1a">bm::match_pair::xor_d64</a></div><div class="ttdeci">bm::id64_t xor_d64</div><div class="ttdoc">recorded digest</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00276">bmxor.h:276</a></div></div>
<div class="ttc" id="astructbm_1_1match__pair_html_ab76ae550e9851327936ca1dd3bf6ba4c"><div class="ttname"><a href="structbm_1_1match__pair.html#ab76ae550e9851327936ca1dd3bf6ba4c">bm::match_pair::match_pair</a></div><div class="ttdeci">match_pair()</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00278">bmxor.h:278</a></div></div>
<div class="ttc" id="astructbm_1_1match__pair_html_af6ee46c5d97cf5c3aeb0f0aef0e9417d"><div class="ttname"><a href="structbm_1_1match__pair.html#af6ee46c5d97cf5c3aeb0f0aef0e9417d">bm::match_pair::match_pair</a></div><div class="ttdeci">match_pair(bvector_size_type idx, bm::id64_t d64)</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00279">bmxor.h:279</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html"><div class="ttname"><a href="structbm_1_1xor__sim__model.html">bm::xor_sim_model</a></div><div class="ttdoc">XOR similarity model.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00790">bmxor.h:791</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_a41de5ad94a60516a4e352c19f11d884b"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#a41de5ad94a60516a4e352c19f11d884b">bm::xor_sim_model::matrix_chain_type</a></div><div class="ttdeci">bm::dynamic_heap_matrix&lt; block_match_chain_type, bv_allocator_type &gt; matrix_chain_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00801">bmxor.h:801</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_a65e172b4611d9d1abe882a980f9fe6b6"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#a65e172b4611d9d1abe882a980f9fe6b6">bm::xor_sim_model::block_match_chain_type</a></div><div class="ttdeci">bm::block_match_chain&lt; size_type &gt; block_match_chain_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00798">bmxor.h:798</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_a6dc4b43d74e8c7f27ea85c4515381981"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#a6dc4b43d74e8c7f27ea85c4515381981">bm::xor_sim_model::size_type</a></div><div class="ttdeci">bvector_type::size_type size_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00794">bmxor.h:794</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_a7b61f5f9739fafab6cb9fd52590b2ece"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#a7b61f5f9739fafab6cb9fd52590b2ece">bm::xor_sim_model::bvector_type</a></div><div class="ttdeci">BV bvector_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00793">bmxor.h:793</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_acb59c04ee2c395077d529d662f210feb"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#acb59c04ee2c395077d529d662f210feb">bm::xor_sim_model::matr</a></div><div class="ttdeci">matrix_chain_type matr</div><div class="ttdoc">model matrix</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00804">bmxor.h:804</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_ae83323d12a5269fe3ade35f44569a328"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#ae83323d12a5269fe3ade35f44569a328">bm::xor_sim_model::bv_blocks</a></div><div class="ttdeci">bvector_type bv_blocks</div><div class="ttdoc">blocks digest</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00805">bmxor.h:805</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__model_html_ae9dcfb48df6abb8975b0de0033c0aacd"><div class="ttname"><a href="structbm_1_1xor__sim__model.html#ae9dcfb48df6abb8975b0de0033c0aacd">bm::xor_sim_model::bv_allocator_type</a></div><div class="ttdeci">bvector_type::allocator_type bv_allocator_type</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00795">bmxor.h:795</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html"><div class="ttname"><a href="structbm_1_1xor__sim__params.html">bm::xor_sim_params</a></div><div class="ttdoc">Parameters for XOR similarity search.</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00058">bmxor.h:59</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_a777f9468e2cf75d79db603b35d59eaa2"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#a777f9468e2cf75d79db603b35d59eaa2">bm::xor_sim_params::stop_gain</a></div><div class="ttdeci">unsigned stop_gain</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00062">bmxor.h:62</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_a8ac8f9f08a60f991fd78708f67d19515"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#a8ac8f9f08a60f991fd78708f67d19515">bm::xor_sim_params::min_lookup_depth</a></div><div class="ttdeci">unsigned min_lookup_depth</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00060">bmxor.h:60</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_ab9ae4ddd083e2156bb8572e8f86e8afb"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#ab9ae4ddd083e2156bb8572e8f86e8afb">bm::xor_sim_params::xor_sim_params</a></div><div class="ttdeci">xor_sim_params()</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00066">bmxor.h:66</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_ae8af72b740b44951728e2429ffa68f6c"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#ae8af72b740b44951728e2429ffa68f6c">bm::xor_sim_params::min_gaps</a></div><div class="ttdeci">unsigned min_gaps</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00064">bmxor.h:64</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_aebb1c0f905470194b0cfa453e07923b4"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#aebb1c0f905470194b0cfa453e07923b4">bm::xor_sim_params::max_lookup_depth</a></div><div class="ttdeci">unsigned max_lookup_depth</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00061">bmxor.h:61</a></div></div>
<div class="ttc" id="astructbm_1_1xor__sim__params_html_af9393fc7693813404eb2c9161f59c3d5"><div class="ttname"><a href="structbm_1_1xor__sim__params.html#af9393fc7693813404eb2c9161f59c3d5">bm::xor_sim_params::target_gain_ratio</a></div><div class="ttdeci">float target_gain_ratio</div><div class="ttdef"><b>Definition:</b> <a href="bmxor_8h_source.html#l00063">bmxor.h:63</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
